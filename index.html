<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Gaji Karyawan Berdasarkan Level (Update)</title>
    
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        /* Styling untuk Tabel */
        #dataGaji {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            table-layout: fixed;
        }
        
        #dataGaji th, #dataGaji td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }

        #dataGaji th {
            background-color: #3f51b5;
            color: white;
            font-weight: bold;
        }
        
        #dataGaji tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        /* Styling untuk Kolom Data */
        .data-label {
            width: 40%;
            font-weight: bold;
            background-color: #f2f2f2;
        }

        .data-value {
            width: 60%;
            min-height: 20px;
        }

        /* Styling untuk Total Gaji */
        #totalGajiRow td {
             background-color: #c5cae9 !important;
        }
        #totalGaji {
            background-color: #e8eaf6 !important;
            font-weight: bold;
        }

        /* Styling untuk Input dan Dropdown */
        select, input[type="text"] {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        
        .bank-ewallet-select, .bank-ewallet-input {
            margin-top: 5px;
        }

        /* Styling untuk Tombol Radio/Pilihan Bank/E-wallet */
        .radio-group label {
            margin-right: 15px;
            cursor: pointer;
        }
        .radio-group input[type="radio"] {
            margin-right: 5px;
        }
        
        /* Styling untuk Tombol Download */
        #downloadImgBtn {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            display: block;
            width: 100%;
            text-align: center;
            box-sizing: border-box;
            margin-bottom: 10px;
        }
        #downloadImgBtn:hover {
            background-color: #45a049;
        }
        
    </style>
</head>
<body>

    <div class="container">
        
        <h2>AGENCY SAHABAT KITA</h2>
        <p>WELCOME TO AGENCY SAHABAT KITA</p>

        <table id="dataGaji">
            <thead>
                <tr>
                    <th colspan="2">GAJI MEMBER FAYA STAR SAHABAT KITA</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="data-label">PILIH LEVEL GAJI</td>
                    <td class="data-value">
                        <select id="levelGaji" onchange="isiGajiOtomatis()">
                            <option value="0">--- Level 0 (Data Kosong) ---</option>
                        </select>
                    </td>
                </tr>
                
                <tr>
                    <td class="data-label">PUST COIN / PUST DIAMOND</td>
                    <td class="data-value pust-data" id="pustData"></td>
                </tr>
                
                <tr>
                    <td class="data-label">ID FAYA</td>
                    <td class="data-value" contenteditable="true" id="idFaya"></td>
                </tr>
                <tr>
                    <td class="data-label">NAMA FAYA</td>
                    <td class="data-value" contenteditable="true" id="namaFaya"></td>
                </tr>
                <tr>
                    <td class="data-label">NOMOR HP</td>
                    <td class="data-value" contenteditable="true" id="nomorHP"></td>
                </tr>
                
                <tr>
                    <td class="data-label">JENIS AKUN</td>
                    <td class="data-value radio-group">
                        <label>
                            <input type="radio" name="jenisAkun" value="bank" checked onchange="updateAkunOptions()"> Bank
                        </label>
                        <label>
                            <input type="radio" name="jenisAkun" value="ewallet" onchange="updateAkunOptions()"> E-Wallet
                        </label>
                    </td>
                </tr>
                
                <tr>
                    <td class="data-label">BANK / E-WALLET</td>
                    <td class="data-value">
                        <select id="selectAkun" class="bank-ewallet-select" onchange="updateNamaBank()">
                            </select>
                        <input type="hidden" id="namaBank" value="">
                    </td>
                </tr>
                
                <tr>
                    <td class="data-label">NOMOR AKUN / HP</td>
                    <td class="data-value" contenteditable="true" id="akunBank"></td>
                </tr>
                <tr>
                    <td class="data-label">NAMA PEMILIK</td>
                    <td class="data-value" contenteditable="true" id="namaPemilik"></td>
                </tr>
                
                <tr>
                    <td class="data-label">GAJI COIN (IDR)</td>
                    <td class="data-value" id="gajiCoin">Rp 0</td>
                </tr>
                <tr>
                    <td class="data-label">GAJI DIAMOND (IDR)</td>
                    <td class="data-value" id="gajiDiamond">Rp 0</td>
                </tr>
                <tr>
                    <td class="data-label">BONUS (IDR)</td>
                    <td class="data-value" id="bonus">Rp 0</td>
                </tr>
                
                <tr>
                    <td class="data-label">DOLAR (Angka Saja)</td>
                    <td class="data-value editable-cell">
                        <input type="text" id="dolarInput" value="0" oninput="hitungTotalGaji()">
                    </td>
                </tr>
                
                <tr id="totalGajiRow">
                    <td class="data-label"><strong>TOTAL GAJIH (IDR)</strong></td>
                    <td class="data-value" id="totalGaji"><strong>Rp 0</strong></td>
                </tr>
            </tbody>
        </table>
        
        <button id="downloadImgBtn">⬇️ DOWNLOAD DATA JADI GAMBAR (IMG)</button>
        
        <div class="catatan">
            <strong>CATATAN:</strong>
            <br>1. Kurs **1 Dolar = Rp 17.000**.
            <br>2. Pilih **Bank** atau **E-Wallet** untuk memuat daftar yang sesuai.
        </div>
    </div>
    
    <script>
        // Data Gaji per Level (Nilai disimpan dalam format angka MURNI)
        const dataGajiLevel = [
            // Level 0 (Kosong/Default)
            { lvl: 0, pustCoin: 0, pustDM: 0, gajiCoin: 0, gajiDiamond: 0, bonus: 0 },
            { lvl: 1, pustCoin: 50000, pustDM: 50000, gajiCoin: 10000, gajiDiamond: 10000, bonus: 7000 },
            { lvl: 2, pustCoin: 100000, pustDM: 100000, gajiCoin: 20000, gajiDiamond: 20000, bonus: 11000 },
            { lvl: 3, pustCoin: 150000, pustDM: 150000, gajiCoin: 25000, gajiDiamond: 25000, bonus: 16000 },
            { lvl: 4, pustCoin: 250000, pustDM: 250000, gajiCoin: 45000, gajiDiamond: 45000, bonus: 20000 },
            { lvl: 5, pustCoin: 400000, pustDM: 400000, gajiCoin: 70000, gajiDiamond: 70000, bonus: 33000 },
            { lvl: 6, pustCoin: 550000, pustDM: 550000, gajiCoin: 100000, gajiDiamond: 100000, bonus: 39000 },
            { lvl: 7, pustCoin: 750000, pustDM: 750000, gajiCoin: 140000, gajiDiamond: 140000, bonus: 47000 },
            { lvl: 8, pustCoin: 1100000, pustDM: 1100000, gajiCoin: 200000, gajiDiamond: 200000, bonus: 70000 },
            { lvl: 9, pustCoin: 1450000, pustDM: 1450000, gajiCoin: 270000, gajiDiamond: 270000, bonus: 90000 },
            { lvl: 10, pustCoin: 1900000, pustDM: 1900000, gajiCoin: 360000, gajiDiamond: 360000, bonus: 126000 },
            { lvl: 11, pustCoin: 2500000, pustDM: 2500000, gajiCoin: 460000, gajiDiamond: 460000, bonus: 169000 },
            { lvl: 12, pustCoin: 3200000, pustDM: 3200000, gajiCoin: 600000, gajiDiamond: 600000, bonus: 203000 },
            { lvl: 13, pustCoin: 4000000, pustDM: 4000000, gajiCoin: 750000, gajiDiamond: 750000, bonus: 263000 },
            { lvl: 14, pustCoin: 5000000, pustDM: 5000000, gajiCoin: 940000, gajiDiamond: 940000, bonus: 328000 },
            { lvl: 15, pustCoin: 6000000, pustDM: 6000000, gajiCoin: 1130000, gajiDiamond: 1130000, bonus: 388000 },
            { lvl: 16, pustCoin: 7000000, pustDM: 7000000, gajiCoin: 1320000, gajiDiamond: 1320000, bonus: 445000 },
            { lvl: 17, pustCoin: 8000000, pustDM: 8000000, gajiCoin: 1500000, gajiDiamond: 1500000, bonus: 526000 },
            { lvl: 18, pustCoin: 10000000, pustDM: 10000000, gajiCoin: 1880000, gajiDiamond: 1880000, bonus: 604000 },
            { lvl: 19, pustCoin: 12200000, pustDM: 12200000, gajiCoin: 2280000, gajiDiamond: 2280000, bonus: 719000 },
            { lvl: 20, pustCoin: 14600000, pustDM: 14600000, gajiCoin: 2720000, gajiDiamond: 2720000, bonus: 836000 }
        ];

        // Daftar Bank dan E-Wallet
        const optionsAkun = {
            bank: [
                'Pilih Bank', 'BCA', 'Mandiri', 'BNI', 'BRI', 'CIMB Niaga', 'BSI', 'Permata', 'Danamon', 'Maybank', 'Panin'
            ],
            ewallet: [
                'Pilih E-Wallet', 'DANA', 'GoPay', 'OVO', 'ShopeePay', 'LinkAja'
            ]
        };

        // Konstanta Kurs Dolar yang baru
        const KURS_DOLAR = 17000; 

        // Fungsi untuk memformat angka kembali menjadi format mata uang
        function formatRupiah(number, includeRp = true) {
            return new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: 'IDR',
                minimumFractionDigits: 0
            }).format(number).replace('IDR', includeRp ? 'Rp' : '');
        }

        // Fungsi untuk Mengisi Opsi Level pada Dropdown
        function populateLevelOptions() {
            const select = document.getElementById('levelGaji');
            for (let i = 1; i <= 20; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `Level ${i}`;
                select.appendChild(option);
            }
        }
        
        // Fungsi untuk mengupdate opsi Bank/E-Wallet
        function updateAkunOptions() {
            const jenis = document.querySelector('input[name="jenisAkun"]:checked').value;
            const selectAkun = document.getElementById('selectAkun');
            
            // Bersihkan opsi lama
            selectAkun.innerHTML = '';
            
            // Isi opsi baru
            optionsAkun[jenis].forEach(nama => {
                const option = document.createElement('option');
                option.value = nama;
                option.textContent = nama;
                selectAkun.appendChild(option);
            });
            
            // Update hidden input agar nama bank/ewallet terbawa saat download
            updateNamaBank();
        }

        // Fungsi untuk menyimpan pilihan Bank/E-Wallet ke hidden input
        function updateNamaBank() {
            const selectAkun = document.getElementById('selectAkun');
            document.getElementById('namaBank').value = selectAkun.value;
        }
        
        // Fungsi untuk Mengisi Data Gaji Otomatis Berdasarkan Level
        function isiGajiOtomatis() {
            const selectedLevel = parseInt(document.getElementById('levelGaji').value);
            const data = dataGajiLevel.find(item => item.lvl === selectedLevel);

            if (data) {
                // Isi data PUST COIN dan PUST DM
                document.getElementById('pustData').textContent = `Coin: ${formatRupiah(data.pustCoin, false)} | Diamond: ${formatRupiah(data.pustDM, false)} | LVL ${data.lvl}`;
                
                // Isi data GAJI COIN, GAJI DIAMOND, dan BONUS
                document.getElementById('gajiCoin').textContent = formatRupiah(data.gajiCoin);
                document.getElementById('gajiDiamond').textContent = formatRupiah(data.gajiDiamond);
                document.getElementById('bonus').textContent = formatRupiah(data.bonus);
                
                // Hitung Total Gaji
                hitungTotalGaji();
            }
        }
        
        // Fungsi Perhitungan Total Gaji
        function hitungTotalGaji() {
            // Ambil data gaji yang sudah terisi otomatis
            const gajiCoin = parseInt(document.getElementById('gajiCoin').textContent.replace(/[^0-9]/g, '')) || 0;
            const gajiDiamond = parseInt(document.getElementById('gajiDiamond').textContent.replace(/[^0-9]/g, '')) || 0;
            const bonus = parseInt(document.getElementById('bonus').textContent.replace(/[^0-9]/g, '')) || 0;
            
            // Ambil nilai Dolar manual
            const dolar = parseInt(document.getElementById('dolarInput').value.replace(/[^0-9]/g, '')) || 0;
            const nilaiDolar = dolar * KURS_DOLAR;
            
            const totalGaji = gajiCoin + gajiDiamond + bonus + nilaiDolar;
            
            // Tampilkan hasil total gaji
            document.getElementById('totalGaji').innerHTML = `<strong>${formatRupiah(totalGaji)}</strong>`;
        }

        // Pemicu Download Gambar (menggunakan html2canvas)
        document.getElementById('downloadImgBtn').addEventListener('click', function() {
            const table = document.getElementById('dataGaji');
            
            html2canvas(table, {
                scale: 2, 
                logging: false,
                useCORS: true 
            }).then(function(canvas) {
                const image = canvas.toDataURL('image/png'); 
                const link = document.createElement('a');
                
                const namaFaya = document.getElementById('namaFaya').textContent.trim() || 'Karyawan';
                link.href = image;
                link.download = `Data_Gaji_Lvl${document.getElementById('levelGaji').value}_${namaFaya.replace(/\s/g, '_')}.png`;
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            });
        });
        
        // Inisialisasi:
        populateLevelOptions();
        updateAkunOptions(); // Memuat daftar Bank di awal
        isiGajiOtomatis(); // Menghitung total gaji di awal (Level 0)
    </script>
</body>
</html>
