<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chamelion Agency - Member Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 25%, #7c3aed 50%, #c026d3 75%, #db2777 100%);
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .water-wave {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 200%;
            height: 100%;
            background: linear-gradient(0deg, 
                rgba(59, 130, 246, 0.8) 0%,
                rgba(37, 99, 235, 0.6) 25%,
                rgba(29, 78, 216, 0.4) 50%,
                rgba(30, 64, 175, 0.2) 75%,
                transparent 100%);
            animation: waveFlow 8s ease-in-out infinite;
        }
        
        .water-wave::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60%;
            background: linear-gradient(0deg,
                rgba(16, 185, 129, 0.7) 0%,
                rgba(5, 150, 105, 0.5) 30%,
                rgba(4, 120, 87, 0.3) 60%,
                transparent 100%);
            animation: waveFlow 6s ease-in-out infinite reverse;
        }
        
        .water-wave::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 40%;
            background: linear-gradient(0deg,
                rgba(14, 165, 233, 0.9) 0%,
                rgba(2, 132, 199, 0.6) 40%,
                rgba(3, 105, 161, 0.3) 70%,
                transparent 100%);
            animation: waveFlow 10s ease-in-out infinite;
        }
        
        @keyframes waveFlow {
            0%, 100% {
                transform: translateX(-50%) translateY(20px);
                opacity: 0.6;
            }
            25% {
                transform: translateX(-45%) translateY(10px);
                opacity: 0.8;
            }
            50% {
                transform: translateX(-50%) translateY(-5px);
                opacity: 1;
            }
            75% {
                transform: translateX(-55%) translateY(5px);
                opacity: 0.9;
            }
        }
        .card-hover {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .card-hover:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0,0,0,0.15), 0 0 30px rgba(59, 130, 246, 0.3);
            background: rgba(255, 255, 255, 0.98);
            border: 1px solid rgba(59, 130, 246, 0.3);
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .premium-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .premium-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }
        
        .premium-button:hover::before {
            left: 100%;
        }
        
        .premium-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }
        .logo-animation {
            animation: logoGlow 3s ease-in-out infinite alternate;
            text-shadow: 0 0 20px rgba(255,255,255,0.8);
            font-weight: 900;
            letter-spacing: 2px;
        }
        @keyframes logoGlow {
            0% { 
                color: #ffffff; 
                text-shadow: 0 0 20px rgba(255,255,255,0.8), 0 0 40px rgba(255,255,255,0.6);
            }
            100% { 
                color: #fbbf24; 
                text-shadow: 0 0 30px rgba(251,191,36,0.9), 0 0 60px rgba(251,191,36,0.7);
            }
        }
        
        .floating-elements {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }
        
        .floating-elements::before,
        .floating-elements::after {
            content: '';
            position: absolute;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }
        
        .floating-elements::before {
            top: 20%;
            left: 10%;
            animation-delay: 0s;
        }
        
        .floating-elements::after {
            top: 60%;
            right: 15%;
            animation-delay: 3s;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0.3; }
            50% { transform: translateY(-20px) rotate(180deg); opacity: 0.6; }
        }
        .member-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
        }
        .member-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        /* VIP Ring Border Styles */
        .vip-ring-regular {
            position: relative;
            padding: 4px;
            border-radius: 50%;
            background: linear-gradient(45deg, #e5e7eb, #d1d5db);
        }
        
        .vip-ring-vip1 {
            position: relative;
            padding: 4px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ef4444, #dc2626, #b91c1c, #991b1b);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.5), inset 0 2px 4px rgba(255,255,255,0.3);
        }
        
        .vip-ring-vip2 {
            position: relative;
            padding: 4px;
            border-radius: 50%;
            background: linear-gradient(45deg, #3b82f6, #2563eb, #1d4ed8, #1e40af);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.5), inset 0 2px 4px rgba(255,255,255,0.3);
        }
        
        .vip-ring-vip3 {
            position: relative;
            padding: 4px;
            border-radius: 50%;
            background: linear-gradient(45deg, #eab308, #d97706, #f59e0b, #fbbf24);
            box-shadow: 0 0 20px rgba(234, 179, 8, 0.5), inset 0 2px 4px rgba(255,255,255,0.3);
        }
        
        .vip-ring-vip4 {
            position: relative;
            padding: 4px;
            border-radius: 50%;
            background: linear-gradient(45deg, #22c55e, #16a34a, #15803d, #166534);
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.5), inset 0 2px 4px rgba(255,255,255,0.3);
        }
        
        .vip-ring-master {
            position: relative;
            padding: 4px;
            border-radius: 50%;
            background: linear-gradient(45deg, #a855f7, #9333ea, #7c3aed, #6d28d9);
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.5), inset 0 2px 4px rgba(255,255,255,0.3);
        }
        
        .vip-ring-admin {
            position: relative;
            padding: 6px;
            border-radius: 50%;
            background: linear-gradient(45deg, #fbbf24, #f59e0b, #d97706, #b45309, #92400e);
            box-shadow: 0 0 25px rgba(251, 191, 36, 0.6), inset 0 2px 6px rgba(255,255,255,0.4);
            animation: adminGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes adminGlow {
            0% { box-shadow: 0 0 25px rgba(251, 191, 36, 0.6), inset 0 2px 6px rgba(255,255,255,0.4); }
            100% { box-shadow: 0 0 35px rgba(251, 191, 36, 0.8), inset 0 2px 8px rgba(255,255,255,0.5); }
        }
        
        .vip-ring-inner {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: white;
            padding: 2px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .vip-ring-photo {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: #f3f4f6;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .profile-frame-overlay {
            position: absolute;
            top: -15%;
            left: -15%;
            width: 130%;
            height: 130%;
            background-image: url('https://i.ibb.co.com/v6C1d7Mc/9540-removebg-preview.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            z-index: 10;
            pointer-events: none;
            opacity: 0.9;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
        }
        
        .profile-frame-overlay.admin-frame {
            filter: drop-shadow(0 4px 12px rgba(251,191,36,0.4)) hue-rotate(20deg) brightness(1.1);
            animation: adminFrameGlow 3s ease-in-out infinite alternate;
        }
        
        @keyframes adminFrameGlow {
            0% { 
                filter: drop-shadow(0 4px 12px rgba(251,191,36,0.4)) hue-rotate(20deg) brightness(1.1);
                transform: scale(1);
            }
            100% { 
                filter: drop-shadow(0 6px 16px rgba(251,191,36,0.6)) hue-rotate(30deg) brightness(1.2);
                transform: scale(1.02);
            }
        }
        
        .profile-frame-overlay.vip-frame {
            filter: drop-shadow(0 4px 10px rgba(59,130,246,0.3)) hue-rotate(240deg) brightness(1.05);
        }
        
        .profile-frame-overlay.master-frame {
            filter: drop-shadow(0 4px 10px rgba(168,85,247,0.4)) hue-rotate(280deg) brightness(1.1);
            animation: masterFrameGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes masterFrameGlow {
            0% { 
                filter: drop-shadow(0 4px 10px rgba(168,85,247,0.4)) hue-rotate(280deg) brightness(1.1);
            }
            100% { 
                filter: drop-shadow(0 6px 14px rgba(168,85,247,0.6)) hue-rotate(290deg) brightness(1.15);
            }
        }
        
        .vip-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
            color: white;
            z-index: 10;
        }
        
        .vip-badge-vip1 { background: linear-gradient(45deg, #ef4444, #dc2626); }
        .vip-badge-vip2 { background: linear-gradient(45deg, #3b82f6, #2563eb); }
        .vip-badge-vip3 { background: linear-gradient(45deg, #eab308, #d97706); }
        .vip-badge-vip4 { background: linear-gradient(45deg, #22c55e, #16a34a); }
        .vip-badge-master { background: linear-gradient(45deg, #a855f7, #9333ea); }
        .vip-badge-admin { 
            background: linear-gradient(45deg, #6b7280, #374151);
            padding: 6px 12px;
            font-size: 11px;
        }
        
        .admin-access-indicator {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(107, 114, 128, 0.9);
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 9px;
            font-weight: bold;
        }
        

    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white p-4 shadow-lg">
        <div class="water-wave"></div>
        <div class="floating-elements"></div>
        <div class="container mx-auto flex justify-between items-center relative z-10">
            <div class="flex items-center space-x-3">
                <img src="https://i.ibb.co.com/wNgtSd5d/IMG-20250915-WA0000.jpg" alt="Logo" class="w-12 h-12 rounded-full" onerror="this.src=''; this.innerHTML='<div class=\'w-12 h-12 bg-white rounded-full flex items-center justify-center text-blue-600 font-bold\'>VCR</div>'">
                <h1 class="text-2xl font-bold logo-animation">CHAMELION AGENCY</h1>
            </div>
            <div class="flex items-center space-x-4">
                <button id="profileBtn" class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all font-semibold">
                    <i class="fas fa-user text-xl mr-2"></i>
                    Profile
                </button>
                <button id="logoutBtn" class="bg-red-500 px-4 py-2 rounded-lg hover:bg-red-600 transition-all hidden">
                    Logout
                </button>
            </div>
        </div>
    </header>

    <!-- Welcome Info Section -->
    <div id="welcomeSection" class="container mx-auto p-6">
        <div class="bg-gradient-to-br from-white via-blue-50 to-purple-50 rounded-xl shadow-2xl p-8 mb-6 border border-white/20">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Selamat Datang di Chamelion Agency</h2>
                <p class="text-gray-600 text-lg">Platform member eksklusif dengan berbagai keuntungan dan fasilitas premium</p>
            </div>
            
            <div class="grid md:grid-cols-3 gap-6 mb-8">
                <div class="text-center p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl shadow-lg border border-blue-200/50 card-hover">
                    <div class="bg-gradient-to-r from-blue-500 to-blue-600 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg">
                        <i class="fas fa-shield-alt text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2 text-gray-800">Akun Terverifikasi</h3>
                    <p class="text-gray-600">Sistem verifikasi berlapis untuk keamanan maksimal</p>
                </div>
                <div class="text-center p-6 bg-gradient-to-br from-yellow-50 to-orange-100 rounded-xl shadow-lg border border-yellow-200/50 card-hover">
                    <div class="bg-gradient-to-r from-yellow-500 to-orange-500 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg">
                        <i class="fas fa-crown text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2 text-gray-800">Status VIP</h3>
                    <p class="text-gray-600">Upgrade ke VIP untuk mendapatkan akses eksklusif</p>
                </div>
                <div class="text-center p-6 bg-gradient-to-br from-purple-50 to-pink-100 rounded-xl shadow-lg border border-purple-200/50 card-hover">
                    <div class="bg-gradient-to-r from-purple-500 to-pink-500 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg">
                        <i class="fas fa-users text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2 text-gray-800">Komunitas Eksklusif</h3>
                    <p class="text-gray-600">Bergabung dengan member premium lainnya</p>
                </div>
            </div>

            <div class="flex justify-center">
                <button id="showLoginBtn" class="premium-button px-8 py-3 rounded-lg transition-all font-semibold">
                    <i class="fas fa-shield-alt mr-2"></i>Login Admin
                </button>
            </div>
            
            <div class="mt-6 p-4 bg-gray-50 rounded-lg">
                <div class="text-center">
                    <i class="fas fa-shield-alt text-gray-600 text-2xl mb-2"></i>
                    <h4 class="font-bold text-gray-800 mb-2">Sistem Kontrol Admin</h4>
                    <p class="text-gray-700 text-sm">
                        Portal ini khusus untuk admin dalam mengelola data member Chamelion Agency. 
                        Sistem terintegrasi untuk manajemen member, kehadiran, dan upgrade VIP.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Form -->
    <div id="loginSection" class="container mx-auto p-6 hidden">
        <div class="max-w-md mx-auto bg-gradient-to-br from-white/90 to-blue-50/90 backdrop-filter backdrop-blur-lg rounded-xl shadow-2xl p-8 border border-white/20">
            <h2 class="text-2xl font-bold text-center mb-6 text-gray-800 flex items-center justify-center">
                <i class="fas fa-user-shield text-blue-600 mr-3"></i>Login Admin
            </h2>
            <form id="loginForm">
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2">Nomor HP:</label>
                    <input type="tel" id="loginPhone" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500" required>
                </div>
                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-bold mb-2">Password:</label>
                    <div class="relative">
                        <input type="password" id="loginPassword" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500 pr-10" required>
                        <button type="button" id="toggleLoginPassword" class="absolute right-3 top-2 text-gray-500 hover:text-gray-700">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                <button type="submit" class="w-full premium-button py-3 rounded-lg transition-all font-semibold">
                    <i class="fas fa-sign-in-alt mr-2"></i>Login
                </button>
                <button type="button" id="backToWelcome" class="w-full mt-3 bg-gradient-to-r from-gray-500 to-gray-600 text-white py-3 rounded-lg hover:from-gray-600 hover:to-gray-700 transition-all font-semibold">
                    <i class="fas fa-arrow-left mr-2"></i>Kembali
                </button>
            </form>
        </div>
    </div>



    <!-- Member Dashboard -->
    <div id="dashboardSection" class="container mx-auto p-6 hidden">
        <!-- Navigation -->
        <div class="bg-gradient-to-r from-white to-blue-50 rounded-xl shadow-2xl p-4 mb-6 border border-white/20">
            <nav class="flex space-x-4">
                <button id="homeTab" class="px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl font-bold shadow-lg transition-all hover:shadow-xl hover:scale-105">
                    <i class="fas fa-home mr-2"></i>HOME
                </button>
                <button id="dataTab" class="px-6 py-3 bg-gradient-to-r from-gray-200 to-gray-300 text-gray-700 rounded-xl font-bold shadow-md hover:from-gray-300 hover:to-gray-400 transition-all hover:scale-105">
                    <i class="fas fa-database mr-2"></i>DATA
                </button>
                <button id="createMemberTab" class="px-6 py-3 bg-gradient-to-r from-gray-200 to-gray-300 text-gray-700 rounded-xl font-bold shadow-md hover:from-gray-300 hover:to-gray-400 transition-all hover:scale-105" style="display: none;">
                    <i class="fas fa-user-plus mr-2"></i>TAMBAH DATA
                </button>
            </nav>
        </div>

        <!-- Home Content -->
        <div id="homeContent">
            <!-- Ads Section -->
            <div class="grid grid-cols-2 gap-6 mb-8">
                <div class="bg-gradient-to-br from-blue-500 via-purple-600 to-indigo-700 rounded-2xl p-6 text-white text-center shadow-2xl transform hover:scale-105 transition-all duration-300 border border-white/20">
                    <div class="bg-white/20 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 backdrop-blur-sm">
                        <i class="fas fa-star text-3xl text-yellow-300"></i>
                    </div>
                    <h3 class="font-bold text-lg mb-2">Member VIP Premium</h3>
                    <p class="text-sm opacity-90">Akses eksklusif ke semua fasilitas Chamelion Agency dengan benefit istimewa!</p>
                </div>
                <div class="bg-gradient-to-br from-emerald-500 via-teal-600 to-cyan-700 rounded-2xl p-6 text-white text-center shadow-2xl transform hover:scale-105 transition-all duration-300 border border-white/20">
                    <div class="bg-white/20 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 backdrop-blur-sm">
                        <i class="fas fa-gift text-3xl text-yellow-300"></i>
                    </div>
                    <h3 class="font-bold text-lg mb-2">Reward Member</h3>
                    <p class="text-sm opacity-90">Dapatkan cashback, bonus poin, dan hadiah menarik setiap bulan!</p>
                </div>
                <div class="bg-gradient-to-br from-orange-500 via-red-600 to-pink-700 rounded-2xl p-6 text-white text-center shadow-2xl transform hover:scale-105 transition-all duration-300 border border-white/20">
                    <div class="bg-white/20 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 backdrop-blur-sm">
                        <i class="fas fa-trophy text-3xl text-yellow-300"></i>
                    </div>
                    <h3 class="font-bold text-lg mb-2">Kompetisi Member</h3>
                    <p class="text-sm opacity-90">Ikuti turnamen eksklusif dengan hadiah jutaan rupiah!</p>
                </div>
                <div class="bg-gradient-to-br from-purple-500 via-pink-600 to-rose-700 rounded-2xl p-6 text-white text-center shadow-2xl transform hover:scale-105 transition-all duration-300 border border-white/20">
                    <div class="bg-white/20 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 backdrop-blur-sm">
                        <i class="fas fa-crown text-3xl text-yellow-300"></i>
                    </div>
                    <h3 class="font-bold text-lg mb-2">Fasilitas Premium</h3>
                    <p class="text-sm opacity-90">Nikmati layanan prioritas, akses VIP lounge, dan konsultasi gratis!</p>
                </div>
            </div>

            <!-- Controls -->
            <div class="bg-gradient-to-r from-white/80 to-blue-50/80 backdrop-filter backdrop-blur-lg rounded-xl shadow-2xl p-4 mb-6 border border-white/30">
                <div class="flex justify-between items-center">
                    <div class="flex space-x-3">
                        <button id="gridView" class="p-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all hover:scale-105">
                            <i class="fas fa-th-large"></i>
                        </button>
                        <button id="listView" class="p-3 bg-gradient-to-r from-gray-200 to-gray-300 text-gray-700 rounded-xl shadow-md hover:shadow-lg transition-all hover:scale-105">
                            <i class="fas fa-list"></i>
                        </button>
                    </div>
                    <div class="flex-1 max-w-md mx-4">
                        <div class="relative">
                            <input type="text" id="searchMembers" placeholder="Cari member..." class="w-full px-4 py-3 pl-10 bg-white/70 backdrop-filter backdrop-blur-sm border border-white/30 rounded-xl focus:outline-none focus:border-blue-500 focus:bg-white/90 transition-all shadow-lg">
                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Members Display -->
            <div id="membersContainer" class="member-grid">
                <!-- Members will be populated here -->
            </div>
        </div>

        <!-- Data Content -->
        <div id="dataContent" class="hidden">
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-6">Gaji Member Chameleon Agency</h2>
                <div id="attendanceData">
                    <!-- Attendance data will be populated here -->
                </div>
                
                <!-- Send Data Button -->
                <div class="mt-8 text-center space-y-4">
                    <button id="sendToGoogleSheets" class="bg-green-600 text-white px-8 py-4 rounded-lg hover:bg-green-700 transition-all font-semibold text-lg shadow-lg">
                        <i class="fas fa-cloud-upload-alt mr-3"></i>
                        Kirim Data ke Google Sheets
                    </button>
                    <div>
                        <button onclick="showGoogleScriptSetup()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-all font-semibold text-sm">
                            <i class="fas fa-cog mr-2"></i>
                            Cara Setup Google Script
                        </button>
                    </div>
                    <p class="text-sm text-gray-600">Data akan dikirim ke Google Spreadsheet secara otomatis</p>
                </div>
                
                <!-- Status Message -->
                <div id="sendStatus" class="hidden mt-4 p-4 rounded-lg">
                    <div class="flex items-center">
                        <i id="statusIcon" class="text-xl mr-3"></i>
                        <div>
                            <h4 id="statusTitle" class="font-bold"></h4>
                            <p id="statusMessage" class="text-sm mt-1"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Create Member Content -->
        <div id="createMemberContent" class="hidden">
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-6 text-center">Tambah Data Member Baru</h2>
                <div class="max-w-2xl mx-auto mb-6 p-4 bg-blue-50 rounded-lg">
                    <div class="flex items-center">
                        <i class="fas fa-info-circle text-blue-600 text-xl mr-3"></i>
                        <div>
                            <h4 class="font-bold text-blue-800">Informasi Penting</h4>
                            <p class="text-blue-700 text-sm mt-1">
                                Form ini hanya untuk menyimpan data member, bukan membuat akun login. 
                                Data yang disimpan akan ditampilkan di daftar member untuk keperluan administrasi.
                            </p>
                        </div>
                    </div>
                </div>
                <form id="adminCreateMemberForm" class="max-w-2xl mx-auto">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Foto Profil:</label>
                            <input type="file" id="adminProfileImage" accept="image/*" class="w-full px-3 py-2 border rounded-lg">
                            <div id="adminImagePreview" class="mt-2 hidden">
                                <img id="adminPreviewImg" class="w-20 h-20 rounded-full object-cover border-2 border-gray-300" alt="Preview">
                            </div>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Nama Lengkap:</label>
                            <input type="text" id="adminRegName" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Umur:</label>
                            <input type="number" id="adminRegAge" min="20" max="50" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">ID Member:</label>
                            <input type="number" id="adminRegId" placeholder="Contoh: 00001" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500" required>
                            <p class="text-xs text-gray-500 mt-1">Format: Hanya angka (00001, 00002, dst.)</p>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Jenis Kelamin:</label>
                            <select id="adminRegGender" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500" required>
                                <option value="">Pilih Jenis Kelamin</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Nomor HP:</label>
                            <input type="tel" id="adminRegPhone" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Tipe Akun:</label>
                            <select id="adminRegAccountType" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500" required onchange="toggleAccountOptions()">
                                <option value="">Pilih Tipe Akun</option>
                                <option value="bank">Bank</option>
                                <option value="ewallet">E-Wallet</option>
                            </select>
                        </div>
                        <div id="bankSection" class="hidden">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Bank:</label>
                            <select id="adminRegBankName" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500">
                                <option value="">Pilih Bank</option>
                                <option value="BCA">Bank BCA</option>
                                <option value="BRI">Bank BRI</option>
                                <option value="BNI">Bank BNI</option>
                                <option value="Mandiri">Bank Mandiri</option>
                                <option value="BSI">Bank BSI</option>
                                <option value="CIMB">Bank CIMB Niaga</option>
                                <option value="Danamon">Bank Danamon</option>
                                <option value="Permata">Bank Permata</option>
                                <option value="BTPN">Bank BTPN</option>
                                <option value="Maybank">Maybank Indonesia</option>
                                <option value="OCBC">Bank OCBC NISP</option>
                                <option value="Panin">Bank Panin</option>
                                <option value="Sinarmas">Bank Sinarmas</option>
                                <option value="Mega">Bank Mega</option>
                                <option value="Bukopin">Bank Bukopin</option>
                                <option value="BJB">Bank BJB</option>
                                <option value="BPD">Bank BPD</option>
                                <option value="Muamalat">Bank Muamalat</option>
                                <option value="Syariah Mandiri">Bank Syariah Mandiri</option>
                                <option value="BCA Syariah">BCA Syariah</option>
                                <option value="BRI Syariah">BRI Syariah</option>
                                <option value="BNI Syariah">BNI Syariah</option>
                                <option value="Jago">Bank Jago</option>
                                <option value="SeaBank">SeaBank</option>
                                <option value="Allo Bank">Allo Bank</option>
                                <option value="Neo Commerce">Neo Commerce</option>
                                <option value="Jenius">Jenius BTPN</option>
                                <option value="Digibank">Digibank DBS</option>
                            </select>
                        </div>
                        <div id="ewalletSection" class="hidden">
                            <label class="block text-gray-700 text-sm font-bold mb-2">E-Wallet:</label>
                            <select id="adminRegEwalletName" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500">
                                <option value="">Pilih E-Wallet</option>
                                <option value="DANA">DANA</option>
                                <option value="OVO">OVO</option>
                                <option value="GoPay">GoPay</option>
                                <option value="LinkAja">LinkAja</option>
                                <option value="ShopeePay">ShopeePay</option>
                                <option value="Sakuku">Sakuku BCA</option>
                                <option value="i.saku">i.saku BNI</option>
                                <option value="T-Cash">T-Cash Telkomsel</option>
                                <option value="DOKU">DOKU Wallet</option>
                                <option value="PayPal">PayPal</option>
                                <option value="Flip">Flip</option>
                                <option value="Bibit">Bibit</option>
                                <option value="Akulaku">Akulaku PayLater</option>
                                <option value="Kredivo">Kredivo</option>
                                <option value="Spaylater">Spaylater</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">
                                <span id="numberLabel">Nomor Rekening/HP:</span>
                            </label>
                            <input type="text" id="adminRegAccountNumber" placeholder="Masukkan nomor rekening atau nomor HP" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Email:</label>
                            <input type="email" id="adminRegEmail" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500" required>
                        </div>

                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Level VIP:</label>
                            <select id="adminRegVipLevel" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500" required>
                                <option value="Regular">Regular</option>
                                <option value="VIP 1">VIP 1</option>
                                <option value="VIP 2">VIP 2</option>
                                <option value="VIP 3">VIP 3</option>
                                <option value="VIP 4">VIP 4</option>
                                <option value="MASTER">MASTER</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Status Verifikasi:</label>
                            <select id="adminRegVerified" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500" required>
                                <option value="false">Belum Terverifikasi</option>
                                <option value="true">Terverifikasi</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mt-8 flex space-x-4">
                        <button type="submit" class="flex-1 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition-all font-semibold">
                            <i class="fas fa-save mr-2"></i>Simpan Data Member
                        </button>
                        <button type="button" id="resetAdminForm" class="flex-1 bg-gray-500 text-white py-3 rounded-lg hover:bg-gray-600 transition-all">
                            <i class="fas fa-undo mr-2"></i>Reset Form
                        </button>
                    </div>
                </form>
                
                <!-- Success Message -->
                <div id="adminCreateSuccess" class="hidden mt-6 p-4 bg-green-50 rounded-lg border border-green-200">
                    <div class="flex items-center">
                        <i class="fas fa-check-circle text-green-600 text-xl mr-3"></i>
                        <div>
                            <h4 class="font-bold text-green-800">Data Member Berhasil Disimpan!</h4>
                            <p id="adminSuccessMessage" class="text-green-700 text-sm mt-1"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">Profile Admin Apps</h2>
                <button id="closeProfile" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="profileContent">
                <!-- Profile content will be populated here -->
            </div>
        </div>
    </div>

    <!-- VIP Upgrade Modal -->
    <div id="vipModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <h2 class="text-2xl font-bold mb-6 text-center">Upgrade VIP</h2>
            <div class="space-y-4">
                <div class="border rounded-lg p-4 hover:border-blue-500 cursor-pointer vip-option" data-vip="VIP 1" data-price="10000">
                    <div class="flex justify-between items-center">
                        <span class="font-semibold">VIP 1</span>
                        <span class="text-blue-600 font-bold">Rp 10.000</span>
                    </div>
                </div>
                <div class="border rounded-lg p-4 hover:border-blue-500 cursor-pointer vip-option" data-vip="VIP 2" data-price="20000">
                    <div class="flex justify-between items-center">
                        <span class="font-semibold">VIP 2</span>
                        <span class="text-blue-600 font-bold">Rp 20.000</span>
                    </div>
                </div>
                <div class="border rounded-lg p-4 hover:border-blue-500 cursor-pointer vip-option" data-vip="VIP 3" data-price="30000">
                    <div class="flex justify-between items-center">
                        <span class="font-semibold">VIP 3</span>
                        <span class="text-blue-600 font-bold">Rp 30.000</span>
                    </div>
                </div>
                <div class="border rounded-lg p-4 hover:border-blue-500 cursor-pointer vip-option" data-vip="VIP 4" data-price="40000">
                    <div class="flex justify-between items-center">
                        <span class="font-semibold">VIP 4</span>
                        <span class="text-blue-600 font-bold">Rp 40.000</span>
                    </div>
                </div>
                <div class="border rounded-lg p-4 hover:border-blue-500 cursor-pointer vip-option" data-vip="MASTER" data-price="60000">
                    <div class="flex justify-between items-center">
                        <span class="font-semibold">MASTER</span>
                        <span class="text-blue-600 font-bold">Rp 60.000</span>
                    </div>
                </div>
                <div class="border rounded-lg p-4 hover:border-blue-500 cursor-pointer vip-option" data-vip="ADMIN" data-price="100000">
                    <div class="flex justify-between items-center">
                        <span class="font-semibold">ADMIN</span>
                        <span class="text-blue-600 font-bold">Rp 100.000</span>
                    </div>
                </div>
            </div>
            <div class="mt-6 flex space-x-4">
                <button id="confirmVipUpgrade" class="flex-1 bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition-all">
                    Konfirmasi Pembayaran
                </button>
                <button id="closeVipModal" class="flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-all">
                    Batal
                </button>
            </div>
        </div>
    </div>

    <!-- Bonus Dolar Modal -->
    <div id="bonusModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">Bonus Lotre Dolar</h2>
                <button id="closeBonusModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="mb-6">
                <div class="bg-yellow-50 rounded-lg p-4 mb-4">
                    <div class="flex items-center mb-2">
                        <i class="fas fa-dollar-sign text-yellow-600 mr-2"></i>
                        <span class="font-semibold text-yellow-800">Kurs: 1$ = Rp 17.000</span>
                    </div>
                    <p class="text-sm text-yellow-700">Maksimal: 100$ = Rp 1.700.000</p>
                </div>
                
                <label class="block text-gray-700 text-sm font-bold mb-2">Jumlah Dolar (1-100):</label>
                <input type="number" id="bonusDolarAmount" min="1" max="100" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500" placeholder="Masukkan jumlah dolar">
                
                <div id="bonusDolarPreview" class="mt-3 p-3 bg-blue-50 rounded-lg hidden">
                    <div class="text-sm text-blue-700">
                        <p><strong>Jumlah:</strong> <span id="previewDolar">0</span>$</p>
                        <p><strong>Nilai Rupiah:</strong> Rp <span id="previewRupiah">0</span></p>
                    </div>
                </div>
            </div>
            
            <div class="flex space-x-4">
                <button id="saveBonusDolar" class="flex-1 bg-yellow-600 text-white py-3 rounded-lg hover:bg-yellow-700 transition-all font-semibold">
                    <i class="fas fa-save mr-2"></i>Simpan Bonus
                </button>
                <button id="cancelBonusDolar" class="flex-1 bg-gray-500 text-white py-3 rounded-lg hover:bg-gray-600 transition-all">
                    Batal
                </button>
            </div>
        </div>
    </div>

    <!-- Salary Modal -->
    <div id="salaryModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">Atur Gaji Member</h2>
                <button id="closeSalaryModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="grid md:grid-cols-3 gap-6 mb-6">
                <!-- Gaji Koin Host -->
                <div class="bg-blue-50 rounded-lg p-4">
                    <h3 class="font-bold text-blue-800 mb-3 flex items-center">
                        <i class="fas fa-coins text-blue-600 mr-2"></i>
                        Gaji Koin Host
                    </h3>
                    <label class="block text-sm font-semibold mb-2">Level (1-20):</label>
                    <select id="coinLevel" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500 mb-3">
                        <option value="">Pilih Level</option>
                        <option value="1">LVL 1 - 50.000 Coin</option>
                        <option value="2">LVL 2 - 100.000 Coin</option>
                        <option value="3">LVL 3 - 150.000 Coin</option>
                        <option value="4">LVL 4 - 250.000 Coin</option>
                        <option value="5">LVL 5 - 400.000 Coin</option>
                        <option value="6">LVL 6 - 550.000 Coin</option>
                        <option value="7">LVL 7 - 750.000 Coin</option>
                        <option value="8">LVL 8 - 1.100.000 Coin</option>
                        <option value="9">LVL 9 - 1.450.000 Coin</option>
                        <option value="10">LVL 10 - 1.900.000 Coin</option>
                        <option value="11">LVL 11 - 2.500.000 Coin</option>
                        <option value="12">LVL 12 - 3.200.000 Coin</option>
                        <option value="13">LVL 13 - 4.000.000 Coin</option>
                        <option value="14">LVL 14 - 5.000.000 Coin</option>
                        <option value="15">LVL 15 - 6.000.000 Coin</option>
                        <option value="16">LVL 16 - 7.000.000 Coin</option>
                        <option value="17">LVL 17 - 8.000.000 Coin</option>
                        <option value="18">LVL 18 - 10.000.000 Coin</option>
                        <option value="19">LVL 19 - 12.200.000 Coin</option>
                        <option value="20">LVL 20 - 14.600.000 Coin</option>
                    </select>
                    <div id="coinSalaryPreview" class="text-sm text-blue-700 font-semibold"></div>
                </div>

                <!-- Gaji Diamond Host -->
                <div class="bg-purple-50 rounded-lg p-4">
                    <h3 class="font-bold text-purple-800 mb-3 flex items-center">
                        <i class="fas fa-gem text-purple-600 mr-2"></i>
                        Gaji Diamond Host
                    </h3>
                    <label class="block text-sm font-semibold mb-2">Level (1-20):</label>
                    <select id="diamondLevel" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-purple-500 mb-3">
                        <option value="">Pilih Level</option>
                        <option value="1">LVL 1 - 50.000 Diamond</option>
                        <option value="2">LVL 2 - 100.000 Diamond</option>
                        <option value="3">LVL 3 - 150.000 Diamond</option>
                        <option value="4">LVL 4 - 250.000 Diamond</option>
                        <option value="5">LVL 5 - 400.000 Diamond</option>
                        <option value="6">LVL 6 - 550.000 Diamond</option>
                        <option value="7">LVL 7 - 750.000 Diamond</option>
                        <option value="8">LVL 8 - 1.100.000 Diamond</option>
                        <option value="9">LVL 9 - 1.450.000 Diamond</option>
                        <option value="10">LVL 10 - 1.900.000 Diamond</option>
                        <option value="11">LVL 11 - 2.500.000 Diamond</option>
                        <option value="12">LVL 12 - 3.200.000 Diamond</option>
                        <option value="13">LVL 13 - 4.000.000 Diamond</option>
                        <option value="14">LVL 14 - 5.000.000 Diamond</option>
                        <option value="15">LVL 15 - 6.000.000 Diamond</option>
                        <option value="16">LVL 16 - 7.000.000 Diamond</option>
                        <option value="17">LVL 17 - 8.000.000 Diamond</option>
                        <option value="18">LVL 18 - 10.000.000 Diamond</option>
                        <option value="19">LVL 19 - 12.200.000 Diamond</option>
                        <option value="20">LVL 20 - 14.000.000 Diamond</option>
                    </select>
                    <div id="diamondSalaryPreview" class="text-sm text-purple-700 font-semibold"></div>
                </div>

                <!-- Gaji Rewed Host -->
                <div class="bg-green-50 rounded-lg p-4">
                    <h3 class="font-bold text-green-800 mb-3 flex items-center">
                        <i class="fas fa-award text-green-600 mr-2"></i>
                        Gaji Rewed Host
                    </h3>
                    <label class="block text-sm font-semibold mb-2">Level (1-20):</label>
                    <select id="rewedLevel" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-green-500 mb-3">
                        <option value="">Pilih Level</option>
                        <option value="1">LVL 1</option>
                        <option value="2">LVL 2</option>
                        <option value="3">LVL 3</option>
                        <option value="4">LVL 4</option>
                        <option value="5">LVL 5</option>
                        <option value="6">LVL 6</option>
                        <option value="7">LVL 7</option>
                        <option value="8">LVL 8</option>
                        <option value="9">LVL 9</option>
                        <option value="10">LVL 10</option>
                        <option value="11">LVL 11</option>
                        <option value="12">LVL 12</option>
                        <option value="13">LVL 13</option>
                        <option value="14">LVL 14</option>
                        <option value="15">LVL 15</option>
                        <option value="16">LVL 16</option>
                        <option value="17">LVL 17</option>
                        <option value="18">LVL 18</option>
                        <option value="19">LVL 19</option>
                        <option value="20">LVL 20</option>
                    </select>
                    <div id="rewedSalaryPreview" class="text-sm text-green-700 font-semibold"></div>
                </div>
            </div>

            <!-- Total Summary -->
            <div class="bg-gray-50 rounded-lg p-4 mb-6">
                <h3 class="font-bold text-gray-800 mb-3">Ringkasan Gaji</h3>
                <div class="grid grid-cols-2 gap-4 text-sm">
                    <div>
                        <p><strong>Gaji Koin:</strong> <span id="totalCoinSalary">Rp 0</span></p>
                        <p><strong>Gaji Diamond:</strong> <span id="totalDiamondSalary">Rp 0</span></p>
                        <p><strong>Gaji Rewed:</strong> <span id="totalRewedSalary">Rp 0</span></p>
                    </div>
                    <div>
                        <p><strong>Bonus Dolar:</strong> <span id="currentBonusDolar">$0 (Rp 0)</span></p>
                        <p class="text-lg font-bold text-blue-600 mt-2"><strong>TOTAL (Tanpa Dolar):</strong> <span id="grandTotalSalary">Rp 0</span></p>
                    </div>
                </div>
            </div>
            
            <div class="flex space-x-4">
                <button id="saveSalaryData" class="flex-1 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition-all font-semibold">
                    <i class="fas fa-save mr-2"></i>Simpan Gaji
                </button>
                <button id="cancelSalaryData" class="flex-1 bg-gray-500 text-white py-3 rounded-lg hover:bg-gray-600 transition-all">
                    Batal
                </button>
            </div>
        </div>
    </div>

    <!-- QRIS Modal -->
    <div id="qrisModal" class="fixed inset-0 bg-black bg-opacity-75 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">QRIS Payment</h2>
                <button id="closeQRISModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="text-center">
                <img src="https://i.ibb.co.com/0jr9YbM1/images-1.png" 
                     alt="QRIS Code" 
                     class="w-64 h-64 mx-auto border rounded-lg shadow-lg"
                     onerror="this.src=''; this.innerHTML='<div class=\'w-64 h-64 bg-gray-200 rounded-lg flex items-center justify-center\'><i class=\'fas fa-qrcode text-6xl text-gray-500\'></i></div>'">
                <p class="mt-4 text-lg font-semibold">Scan dengan aplikasi pembayaran Anda</p>
                <p class="text-sm text-gray-600 mt-2">Nama Pemilik: <strong>ADMIN</strong></p>
            </div>
        </div>
    </div>

    <!-- Payment Modal -->
    <div id="paymentModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-lg w-full mx-4 max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">Pembayaran</h2>
                <button id="closePaymentModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <!-- Payment Summary -->
            <div class="bg-blue-50 rounded-lg p-4 mb-6">
                <div class="flex justify-between items-center">
                    <span class="font-semibold">Upgrade ke:</span>
                    <span id="paymentVipLevel" class="text-blue-600 font-bold"></span>
                </div>
                <div class="flex justify-between items-center mt-2">
                    <span class="font-semibold">Total Pembayaran:</span>
                    <span id="paymentAmount" class="text-green-600 font-bold text-xl"></span>
                </div>
            </div>

            <!-- Owner Info -->
            <div class="bg-blue-50 rounded-lg p-4 mb-6">
                <h3 class="font-bold text-blue-800 mb-2">Informasi Pemilik Rekening:</h3>
                <p class="text-blue-700"><strong>Nama Pemilik:</strong> ADMIN</p>
            </div>

            <!-- Payment Methods -->
            <div class="space-y-6">
                <!-- Bank Transfer -->
                <div>
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <i class="fas fa-university text-blue-600 mr-2"></i>
                        PAY BANK
                    </h3>
                    <div class="space-y-3">
                        <div class="border rounded-lg p-4 hover:border-blue-500 cursor-pointer payment-method" data-method="BANK MANDIRI" data-number="12234567789">
                            <div class="flex justify-between items-center">
                                <div class="flex items-center">
                                    <div class="w-12 h-8 bg-blue-700 rounded flex items-center justify-center mr-3">
                                        <span class="text-white font-bold text-xs">MDR</span>
                                    </div>
                                    <span class="font-semibold">Bank Mandiri</span>
                                </div>
                                <span class="text-gray-600">12234567789</span>
                            </div>
                        </div>
                        <div class="border rounded-lg p-4 hover:border-blue-500 cursor-pointer payment-method" data-method="BANK BSI" data-number="12345567890">
                            <div class="flex justify-between items-center">
                                <div class="flex items-center">
                                    <div class="w-12 h-8 bg-green-600 rounded flex items-center justify-center mr-3">
                                        <span class="text-white font-bold text-xs">BSI</span>
                                    </div>
                                    <span class="font-semibold">Bank BSI</span>
                                </div>
                                <span class="text-gray-600">12345567890</span>
                            </div>
                        </div>
                        <div class="border rounded-lg p-4 hover:border-blue-500 cursor-pointer payment-method" data-method="BANK BCA" data-number="09876543211">
                            <div class="flex justify-between items-center">
                                <div class="flex items-center">
                                    <div class="w-12 h-8 bg-blue-600 rounded flex items-center justify-center mr-3">
                                        <span class="text-white font-bold text-xs">BCA</span>
                                    </div>
                                    <span class="font-semibold">Bank BCA</span>
                                </div>
                                <span class="text-gray-600">09876543211</span>
                            </div>
                        </div>
                        <div class="border rounded-lg p-4 hover:border-blue-500 cursor-pointer payment-method" data-method="BANK SEABANK" data-number="0987655421">
                            <div class="flex justify-between items-center">
                                <div class="flex items-center">
                                    <div class="w-12 h-8 bg-teal-600 rounded flex items-center justify-center mr-3">
                                        <span class="text-white font-bold text-xs">SEA</span>
                                    </div>
                                    <span class="font-semibold">Bank SeaBank</span>
                                </div>
                                <span class="text-gray-600">0987655421</span>
                            </div>
                        </div>
                        <div class="border rounded-lg p-4 hover:border-blue-500 cursor-pointer payment-method" data-method="BANK BNI" data-number="12345678900">
                            <div class="flex justify-between items-center">
                                <div class="flex items-center">
                                    <div class="w-12 h-8 bg-orange-500 rounded flex items-center justify-center mr-3">
                                        <span class="text-white font-bold text-xs">BNI</span>
                                    </div>
                                    <span class="font-semibold">Bank BNI</span>
                                </div>
                                <span class="text-gray-600">12345678900</span>
                            </div>
                        </div>
                        <div class="border rounded-lg p-4 hover:border-blue-500 cursor-pointer payment-method" data-method="BANK BRI" data-number="1234567890">
                            <div class="flex justify-between items-center">
                                <div class="flex items-center">
                                    <div class="w-12 h-8 bg-blue-800 rounded flex items-center justify-center mr-3">
                                        <span class="text-white font-bold text-xs">BRI</span>
                                    </div>
                                    <span class="font-semibold">Bank BRI</span>
                                </div>
                                <span class="text-gray-600">1234567890</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- E-Wallet -->
                <div>
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <i class="fas fa-mobile-alt text-green-600 mr-2"></i>
                        PAY E-WALLET
                    </h3>
                    <div class="space-y-3">
                        <div class="border rounded-lg p-4 hover:border-blue-500 cursor-pointer payment-method" data-method="DANA" data-number="089646775883">
                            <div class="flex justify-between items-center">
                                <div class="flex items-center">
                                    <div class="w-12 h-8 bg-blue-500 rounded flex items-center justify-center mr-3">
                                        <span class="text-white font-bold text-xs">DANA</span>
                                    </div>
                                    <span class="font-semibold">DANA</span>
                                </div>
                                <span class="text-gray-600">089646775883</span>
                            </div>
                        </div>
                        <div class="border rounded-lg p-4 hover:border-blue-500 cursor-pointer payment-method" data-method="OVO" data-number="089646775883">
                            <div class="flex justify-between items-center">
                                <div class="flex items-center">
                                    <div class="w-12 h-8 bg-purple-600 rounded flex items-center justify-center mr-3">
                                        <span class="text-white font-bold text-xs">OVO</span>
                                    </div>
                                    <span class="font-semibold">OVO</span>
                                </div>
                                <span class="text-gray-600">089646775883</span>
                            </div>
                        </div>
                        <div class="border rounded-lg p-4 hover:border-blue-500 cursor-pointer payment-method" data-method="GOPAY" data-number="089646775883">
                            <div class="flex justify-between items-center">
                                <div class="flex items-center">
                                    <div class="w-12 h-8 bg-green-500 rounded flex items-center justify-center mr-3">
                                        <span class="text-white font-bold text-xs">GOPAY</span>
                                    </div>
                                    <span class="font-semibold">GoPay</span>
                                </div>
                                <span class="text-gray-600">089646775883</span>
                            </div>
                        </div>
                        <div class="border rounded-lg p-4 hover:border-blue-500 cursor-pointer payment-method" data-method="LINKAJA" data-number="089646775883">
                            <div class="flex justify-between items-center">
                                <div class="flex items-center">
                                    <div class="w-12 h-8 bg-red-600 rounded flex items-center justify-center mr-3">
                                        <span class="text-white font-bold text-xs">LINK</span>
                                    </div>
                                    <span class="font-semibold">LinkAja</span>
                                </div>
                                <span class="text-gray-600">089646775883</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- QRIS Payment -->
                <div>
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <i class="fas fa-qrcode text-purple-600 mr-2"></i>
                        QRIS PAY
                    </h3>
                    <div class="border rounded-lg p-4 hover:border-blue-500 cursor-pointer payment-method" data-method="QRIS" data-number="Scan QR Code">
                        <div class="text-center">
                            <div class="mb-3">
                                <img src="https://i.ibb.co.com/0jr9YbM1/images-1.png" 
                                     alt="QRIS Code" 
                                     class="w-32 h-32 mx-auto border rounded-lg cursor-pointer hover:shadow-lg transition-all"
                                     onclick="showQRISModal()"
                                     onerror="this.src=''; this.innerHTML='<div class=\'w-32 h-32 bg-gray-200 rounded-lg flex items-center justify-center\'><i class=\'fas fa-qrcode text-4xl text-gray-500\'></i></div>'">
                            </div>
                            <p class="font-semibold">Scan QRIS Code</p>
                            <p class="text-sm text-gray-600">Klik gambar untuk memperbesar</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Upload Bukti Pembayaran -->
            <div class="mt-6 p-4 bg-yellow-50 rounded-lg">
                <h4 class="font-bold text-yellow-800 mb-3 flex items-center">
                    <i class="fas fa-upload mr-2"></i>
                    Upload Bukti Pembayaran
                </h4>
                <input type="file" id="paymentProof" accept="image/*" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500">
                <p class="text-sm text-yellow-700 mt-2">Upload screenshot atau foto bukti transfer/pembayaran Anda</p>
            </div>

            <!-- Selected Payment Info -->
            <div id="selectedPaymentInfo" class="hidden mt-6 p-4 bg-green-50 rounded-lg">
                <h4 class="font-bold text-green-800 mb-2">Metode Pembayaran Dipilih:</h4>
                <div id="paymentDetails" class="text-sm text-green-700"></div>
            </div>

            <!-- Action Buttons -->
            <div class="mt-6 flex space-x-4">
                <button id="processPayment" class="flex-1 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition-all font-semibold disabled:bg-gray-400" disabled>
                    <i class="fas fa-credit-card mr-2"></i>Bayar Sekarang
                </button>
                <button id="cancelPayment" class="flex-1 bg-gray-500 text-white py-3 rounded-lg hover:bg-gray-600 transition-all">
                    Batal
                </button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let members = JSON.parse(localStorage.getItem('vcrMembers')) || [];
        let attendanceData = JSON.parse(localStorage.getItem('vcrAttendance')) || {};
        let isGridView = true;
        let selectedVipLevel = null;
        let selectedVipPrice = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            checkAutoReset();
            setupEventListeners();
            checkPendingProcessing();
            
            // Check if user is logged in
            const savedUser = localStorage.getItem('vcrCurrentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showDashboard();
            }
        });

        function setupEventListeners() {
            // Navigation
            document.getElementById('showLoginBtn').addEventListener('click', () => showSection('loginSection'));
            document.getElementById('backToWelcome').addEventListener('click', () => showSection('welcomeSection'));
            
            // Password toggles
            setupPasswordToggle('toggleLoginPassword', 'loginPassword');
            
            // Forms
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('adminCreateMemberForm').addEventListener('submit', handleAdminCreateMember);
            
            // Dashboard navigation
            document.getElementById('homeTab').addEventListener('click', () => switchTab('home'));
            document.getElementById('dataTab').addEventListener('click', () => switchTab('data'));
            document.getElementById('createMemberTab').addEventListener('click', () => switchTab('createMember'));
            
            // View toggles
            document.getElementById('gridView').addEventListener('click', () => toggleView(true));
            document.getElementById('listView').addEventListener('click', () => toggleView(false));
            
            // Search
            document.getElementById('searchMembers').addEventListener('input', filterMembers);
            
            // Profile modal
            document.getElementById('profileBtn').addEventListener('click', showProfile);
            document.getElementById('closeProfile').addEventListener('click', () => {
                document.getElementById('profileModal').classList.add('hidden');
            });
            
            // VIP modal
            document.getElementById('closeVipModal').addEventListener('click', () => {
                document.getElementById('vipModal').classList.add('hidden');
            });
            
            // VIP options
            document.querySelectorAll('.vip-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.vip-option').forEach(opt => opt.classList.remove('border-blue-500', 'bg-blue-50'));
                    this.classList.add('border-blue-500', 'bg-blue-50');
                    selectedVipLevel = this.dataset.vip;
                    selectedVipPrice = this.dataset.price;
                });
            });
            
            document.getElementById('confirmVipUpgrade').addEventListener('click', showPaymentModal);
            
            // Payment modal
            document.getElementById('closePaymentModal').addEventListener('click', () => {
                document.getElementById('paymentModal').classList.add('hidden');
            });
            
            document.getElementById('cancelPayment').addEventListener('click', () => {
                document.getElementById('paymentModal').classList.add('hidden');
            });
            
            // Payment methods
            document.querySelectorAll('.payment-method').forEach(method => {
                method.addEventListener('click', function() {
                    document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('border-blue-500', 'bg-blue-50'));
                    this.classList.add('border-blue-500', 'bg-blue-50');
                    
                    const methodName = this.dataset.method;
                    const methodNumber = this.dataset.number;
                    
                    document.getElementById('selectedPaymentInfo').classList.remove('hidden');
                    document.getElementById('paymentDetails').innerHTML = `
                        <strong>${methodName}</strong><br>
                        ${methodNumber !== '-' ? `Nomor: ${methodNumber}` : 'Silakan scan QR code di aplikasi'}
                    `;
                    
                    document.getElementById('processPayment').disabled = false;
                });
            });
            
            document.getElementById('processPayment').addEventListener('click', processVipUpgrade);
            
            // QRIS Modal
            document.getElementById('closeQRISModal').addEventListener('click', () => {
                document.getElementById('qrisModal').classList.add('hidden');
            });
            
            // Bonus Modal
            document.getElementById('closeBonusModal').addEventListener('click', () => {
                document.getElementById('bonusModal').classList.add('hidden');
            });
            document.getElementById('cancelBonusDolar').addEventListener('click', () => {
                document.getElementById('bonusModal').classList.add('hidden');
            });
            document.getElementById('saveBonusDolar').addEventListener('click', saveBonusDolar);
            document.getElementById('bonusDolarAmount').addEventListener('input', updateBonusPreview);
            
            // Salary Modal
            document.getElementById('closeSalaryModal').addEventListener('click', () => {
                document.getElementById('salaryModal').classList.add('hidden');
            });
            document.getElementById('cancelSalaryData').addEventListener('click', () => {
                document.getElementById('salaryModal').classList.add('hidden');
            });
            document.getElementById('saveSalaryData').addEventListener('click', saveSalaryData);
            document.getElementById('coinLevel').addEventListener('change', updateSalaryPreviews);
            document.getElementById('diamondLevel').addEventListener('change', updateSalaryPreviews);
            document.getElementById('rewedLevel').addEventListener('change', updateSalaryPreviews);
            
            // Admin form controls
            document.getElementById('resetAdminForm').addEventListener('click', resetAdminForm);
            document.getElementById('adminProfileImage').addEventListener('change', previewAdminImage);
            
            // Logout
            document.getElementById('logoutBtn').addEventListener('click', logout);
            
            // Send to Google Sheets
            document.getElementById('sendToGoogleSheets').addEventListener('click', sendDataToGoogleSheets);
        }

        function showSection(sectionId) {
            const sections = ['welcomeSection', 'loginSection', 'dashboardSection'];
            sections.forEach(section => {
                document.getElementById(section).classList.add('hidden');
            });
            document.getElementById(sectionId).classList.remove('hidden');
        }

        function setupPasswordToggle(buttonId, inputId) {
            document.getElementById(buttonId).addEventListener('click', function() {
                const input = document.getElementById(inputId);
                const icon = this.querySelector('i');
                
                if (input.type === 'password') {
                    input.type = 'text';
                    icon.classList.remove('fa-eye');
                    icon.classList.add('fa-eye-slash');
                } else {
                    input.type = 'password';
                    icon.classList.remove('fa-eye-slash');
                    icon.classList.add('fa-eye');
                }
            });
        }

        function handleLogin(e) {
            e.preventDefault();
            const phone = document.getElementById('loginPhone').value;
            const password = document.getElementById('loginPassword').value;
            
            // Check for special admin login
            if (phone === '0800' && password === '001') {
                // Create special admin user
                currentUser = {
                    id: 'ADMIN001',
                    name: 'SUPER ADMIN',
                    age: 30,
                    gender: 'Admin',
                    phone: '0800',
                    bank: 'ADMIN BANK',
                    email: 'admin@chamelionagency.com',
                    password: '001',
                    vipLevel: 'ADMIN',
                    verified: true,
                    registrationDate: new Date().toLocaleDateString('id-ID'),
                    profileImage: null,
                    isSpecialAdmin: true
                };
                
                localStorage.setItem('vcrCurrentUser', JSON.stringify(currentUser));
                showDashboard();
                alert('🔐 Login Admin Berhasil! Selamat datang SUPER ADMIN\n\n✅ Akses penuh ke semua member\n✅ Kontrol sistem lengkap\n✅ Manajemen VIP dan kehadiran');
                return;
            }
            
            // Regular user login
            const user = members.find(m => m.phone === phone && m.password === password);
            
            if (user) {
                currentUser = user;
                localStorage.setItem('vcrCurrentUser', JSON.stringify(user));
                showDashboard();
                alert('Login berhasil! Selamat datang ' + user.name);
            } else {
                alert('Nomor HP atau password salah!');
            }
        }



        function showDashboard() {
            showSection('dashboardSection');
            document.getElementById('logoutBtn').classList.remove('hidden');
            
            // Show create member tab only for admin users
            if (currentUser && (currentUser.vipLevel === 'ADMIN' || currentUser.isSpecialAdmin)) {
                document.getElementById('createMemberTab').style.display = 'block';
            } else {
                document.getElementById('createMemberTab').style.display = 'none';
            }
            
            displayMembers();
            displayAttendanceData();
        }

        function switchTab(tab) {
            const homeTab = document.getElementById('homeTab');
            const dataTab = document.getElementById('dataTab');
            const createMemberTab = document.getElementById('createMemberTab');
            const homeContent = document.getElementById('homeContent');
            const dataContent = document.getElementById('dataContent');
            const createMemberContent = document.getElementById('createMemberContent');
            
            // Reset all tabs
            [homeTab, dataTab, createMemberTab].forEach(tabBtn => {
                tabBtn.classList.add('bg-gray-200', 'text-gray-700');
                tabBtn.classList.remove('bg-blue-600', 'text-white');
            });
            
            // Hide all content
            [homeContent, dataContent, createMemberContent].forEach(content => {
                content.classList.add('hidden');
            });
            
            // Show selected tab and content
            if (tab === 'home') {
                homeTab.classList.add('bg-blue-600', 'text-white');
                homeTab.classList.remove('bg-gray-200', 'text-gray-700');
                homeContent.classList.remove('hidden');
            } else if (tab === 'data') {
                dataTab.classList.add('bg-blue-600', 'text-white');
                dataTab.classList.remove('bg-gray-200', 'text-gray-700');
                dataContent.classList.remove('hidden');
            } else if (tab === 'createMember') {
                createMemberTab.classList.add('bg-blue-600', 'text-white');
                createMemberTab.classList.remove('bg-gray-200', 'text-gray-700');
                createMemberContent.classList.remove('hidden');
            }
        }

        function toggleView(grid) {
            isGridView = grid;
            const gridBtn = document.getElementById('gridView');
            const listBtn = document.getElementById('listView');
            const container = document.getElementById('membersContainer');
            
            if (grid) {
                gridBtn.classList.add('bg-blue-600', 'text-white');
                gridBtn.classList.remove('bg-gray-200', 'text-gray-700');
                listBtn.classList.add('bg-gray-200', 'text-gray-700');
                listBtn.classList.remove('bg-blue-600', 'text-white');
                container.className = 'member-grid';
            } else {
                listBtn.classList.add('bg-blue-600', 'text-white');
                listBtn.classList.remove('bg-gray-200', 'text-gray-700');
                gridBtn.classList.add('bg-gray-200', 'text-gray-700');
                gridBtn.classList.remove('bg-blue-600', 'text-white');
                container.className = 'member-list';
            }
            displayMembers();
        }

        function displayMembers() {
            const container = document.getElementById('membersContainer');
            const searchTerm = document.getElementById('searchMembers').value.toLowerCase();
            
            const filteredMembers = members.filter(member => 
                member.name.toLowerCase().includes(searchTerm) ||
                member.id.toLowerCase().includes(searchTerm)
            );
            
            container.innerHTML = '';
            
            filteredMembers.forEach(member => {
                const memberCard = createMemberCard(member);
                container.appendChild(memberCard);
            });
        }

        function createMemberCard(member) {
            const div = document.createElement('div');
            const attendanceStatus = attendanceData[member.id] || 'Belum Hadir';
            
            // Get VIP ring class
            const vipRingClass = getVipRingClass(member.vipLevel);
            const vipBadgeClass = getVipBadgeClass(member.vipLevel);
            
            // Get frame class based on VIP level
            const frameClass = getFrameClass(member.vipLevel);
            
            // Check if current user is admin and can access this member
            const canAccess = currentUser && (currentUser.vipLevel === 'ADMIN' || currentUser.id === member.id || currentUser.isSpecialAdmin);
            const showAdminAccess = currentUser && (currentUser.vipLevel === 'ADMIN' || currentUser.isSpecialAdmin) && member.id !== currentUser.id;
            
            if (isGridView) {
                div.className = `bg-white rounded-xl shadow-lg p-6 card-hover`;
                div.innerHTML = `
                    ${getVipBadge(member.vipLevel, vipBadgeClass)}
                    ${showAdminAccess ? `<div class="admin-access-indicator">${currentUser.isSpecialAdmin ? 'SUPER ADMIN' : 'ADMIN ACCESS'}</div>` : ''}
                    <div class="text-center mb-4">
                        <div class="w-16 h-16 mx-auto mb-3 ${vipRingClass}">
                            <div class="vip-ring-inner">
                                <div class="vip-ring-photo">
                                    ${member.profileImage ? 
                                        `<img src="${member.profileImage}" alt="Profile" class="w-full h-full object-cover rounded-full">` :
                                        `<i class="fas fa-user text-2xl text-gray-500"></i>`
                                    }
                                    <div class="profile-frame-overlay ${frameClass}"></div>
                                </div>
                            </div>
                        </div>
                        <h3 class="font-bold text-lg">${member.name}</h3>
                        <p class="text-sm text-gray-600">${member.id}</p>
                        ${member.verified ? '<i class="fas fa-check-circle text-green-500 ml-1"></i>' : ''}
                    </div>
                    <div class="space-y-2 text-sm">
                        <p><strong>Umur:</strong> ${member.age}</p>
                        <p><strong>ID Bank:</strong> ${member.bank}</p>
                        <p><strong>VIP:</strong> <span class="px-2 py-1 ${getVipLevelColor(member.vipLevel)} rounded text-xs">${member.vipLevel}</span></p>
                    </div>
                    ${canAccess ? `
                    <div class="mt-4 space-y-2">
                        <div class="flex space-x-1">
                            <button onclick="markSalary('${member.id}', 'SUDAH DI GAJI')" class="flex-1 bg-green-500 text-white py-1 rounded text-xs hover:bg-green-600 transition-all">
                                SUDAH DI GAJI
                            </button>
                            <button onclick="markSalary('${member.id}', 'BELUM DI GAJI')" class="flex-1 bg-red-500 text-white py-1 rounded text-xs hover:bg-red-600 transition-all">
                                BELUM DI GAJI
                            </button>
                        </div>
                        <button onclick="showBonusModal('${member.id}')" class="w-full bg-yellow-500 text-white py-1 rounded text-xs hover:bg-yellow-600 transition-all">
                            Bonus Lotre Dolar
                        </button>
                        <button onclick="showSalaryModal('${member.id}')" class="w-full bg-blue-500 text-white py-1 rounded text-xs hover:bg-blue-600 transition-all">
                            Atur Gaji Member
                        </button>
                    </div>
                    <div class="mt-2 text-center">
                        <span class="text-xs px-2 py-1 rounded ${attendanceStatus === 'SUDAH DI GAJI' ? 'bg-green-100 text-green-800' : attendanceStatus === 'BELUM DI GAJI' ? 'bg-red-100 text-red-800' : 'bg-gray-100 text-gray-600'}">
                            ${attendanceStatus || 'BELUM DI GAJI'}
                        </span>
                    </div>
                    ` : `
                    <div class="mt-4 text-center">
                        <div class="bg-gray-100 p-3 rounded-lg">
                            <i class="fas fa-lock text-gray-400 text-xl mb-2"></i>
                            <p class="text-xs text-gray-500">Akses Terbatas</p>
                        </div>
                    </div>
                    `}
                `;
            } else {
                div.className = `bg-white rounded-lg shadow p-4 flex items-center justify-between`;
                div.innerHTML = `
                    ${getVipBadge(member.vipLevel, vipBadgeClass)}
                    ${showAdminAccess ? `<div class="admin-access-indicator">${currentUser.isSpecialAdmin ? 'SUPER ADMIN' : 'ADMIN ACCESS'}</div>` : ''}
                    <div class="flex items-center space-x-4">
                        <div class="w-12 h-12 ${vipRingClass}">
                            <div class="vip-ring-inner">
                                <div class="vip-ring-photo">
                                    ${member.profileImage ? 
                                        `<img src="${member.profileImage}" alt="Profile" class="w-full h-full object-cover rounded-full">` :
                                        `<i class="fas fa-user text-gray-500"></i>`
                                    }
                                    <div class="profile-frame-overlay ${frameClass}"></div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h3 class="font-semibold">${member.name}</h3>
                            <p class="text-sm text-gray-600">${member.id} • ${member.age} tahun • ${member.bank}</p>
                            <span class="text-xs px-2 py-1 ${getVipLevelColor(member.vipLevel)} rounded">${member.vipLevel}</span>
                        </div>
                    </div>
                    ${canAccess ? `
                    <div class="flex items-center space-x-1">
                        <span class="text-xs px-2 py-1 rounded ${attendanceStatus === 'SUDAH DI GAJI' ? 'bg-green-100 text-green-800' : attendanceStatus === 'BELUM DI GAJI' ? 'bg-red-100 text-red-800' : 'bg-gray-100 text-gray-600'}">
                            ${attendanceStatus || 'BELUM DI GAJI'}
                        </span>
                        <button onclick="markSalary('${member.id}', 'SUDAH DI GAJI')" class="bg-green-500 text-white px-2 py-1 rounded hover:bg-green-600 transition-all text-xs">
                            SUDAH
                        </button>
                        <button onclick="markSalary('${member.id}', 'BELUM DI GAJI')" class="bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600 transition-all text-xs">
                            BELUM
                        </button>
                        <button onclick="showBonusModal('${member.id}')" class="bg-yellow-500 text-white px-2 py-1 rounded hover:bg-yellow-600 transition-all text-xs">
                            BONUS
                        </button>
                        <button onclick="showSalaryModal('${member.id}')" class="bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600 transition-all text-xs">
                            GAJI
                        </button>
                    </div>
                    ` : `
                    <div class="flex items-center">
                        <div class="bg-gray-100 p-2 rounded-lg">
                            <i class="fas fa-lock text-gray-400"></i>
                            <span class="text-xs text-gray-500 ml-1">Terbatas</span>
                        </div>
                    </div>
                    `}
                `;
            }
            
            return div;
        }
        
        function getVipRingClass(vipLevel) {
            switch(vipLevel) {
                case 'VIP 1': return 'vip-ring-vip1';
                case 'VIP 2': return 'vip-ring-vip2';
                case 'VIP 3': return 'vip-ring-vip3';
                case 'VIP 4': return 'vip-ring-vip4';
                case 'MASTER': return 'vip-ring-master';
                case 'ADMIN': return 'vip-ring-admin';
                default: return 'vip-ring-regular';
            }
        }
        
        function getVipBadgeClass(vipLevel) {
            switch(vipLevel) {
                case 'VIP 1': return 'vip-badge-vip1';
                case 'VIP 2': return 'vip-badge-vip2';
                case 'VIP 3': return 'vip-badge-vip3';
                case 'VIP 4': return 'vip-badge-vip4';
                case 'MASTER': return 'vip-badge-master';
                case 'ADMIN': return 'vip-badge-admin';
                default: return '';
            }
        }
        
        function getVipBadge(vipLevel, badgeClass) {
            if (vipLevel === 'Regular') return '';
            if (vipLevel === 'ADMIN') return ''; // Remove ADMIN badge
            
            return `<div class="vip-badge ${badgeClass}">${vipLevel}</div>`;
        }
        
        function getVipLevelColor(vipLevel) {
            switch(vipLevel) {
                case 'VIP 1': return 'bg-red-100 text-red-800';
                case 'VIP 2': return 'bg-blue-100 text-blue-800';
                case 'VIP 3': return 'bg-yellow-100 text-yellow-800';
                case 'VIP 4': return 'bg-green-100 text-green-800';
                case 'MASTER': return 'bg-purple-100 text-purple-800';
                case 'ADMIN': return 'bg-gray-100 text-gray-800';
                default: return 'bg-gray-100 text-gray-600';
            }
        }
        
        function getFrameClass(vipLevel) {
            switch(vipLevel) {
                case 'ADMIN': return 'admin-frame';
                case 'MASTER': return 'master-frame';
                case 'VIP 1':
                case 'VIP 2':
                case 'VIP 3':
                case 'VIP 4': return 'vip-frame';
                default: return '';
            }
        }

        function filterMembers() {
            displayMembers();
        }

        // Salary system variables
        let currentMemberId = null;
        
        // Salary data
        const salaryData = {
            coin: {
                1: { coins: 50000, salary: 12750 },
                2: { coins: 100000, salary: 22100 },
                3: { coins: 150000, salary: 28900 },
                4: { coins: 250000, salary: 47600 },
                5: { coins: 400000, salary: 76500 },
                6: { coins: 550000, salary: 105400 },
                7: { coins: 750000, salary: 141100 },
                8: { coins: 1100000, salary: 207400 },
                9: { coins: 1450000, salary: 275400 },
                10: { coins: 1900000, salary: 365500 },
                11: { coins: 2500000, salary: 469200 },
                12: { coins: 3200000, salary: 601800 },
                13: { coins: 4000000, salary: 756500 },
                14: { coins: 5000000, salary: 948600 },
                15: { coins: 6000000, salary: 1139000 },
                16: { coins: 7000000, salary: 1327700 },
                17: { coins: 8000000, salary: 1518100 },
                18: { coins: 10000000, salary: 1881900 },
                19: { coins: 12200000, salary: 2284800 },
                20: { coins: 14600000, salary: 2723400 }
            },
            diamond: {
                1: { diamonds: 50000, salary: 12750 },
                2: { diamonds: 100000, salary: 22100 },
                3: { diamonds: 150000, salary: 28900 },
                4: { diamonds: 250000, salary: 47600 },
                5: { diamonds: 400000, salary: 76500 },
                6: { diamonds: 550000, salary: 105400 },
                7: { diamonds: 750000, salary: 141100 },
                8: { diamonds: 1100000, salary: 207400 },
                9: { diamonds: 1450000, salary: 275400 },
                10: { diamonds: 1900000, salary: 365500 },
                11: { diamonds: 2500000, salary: 469200 },
                12: { diamonds: 3200000, salary: 601800 },
                13: { diamonds: 4000000, salary: 756500 },
                14: { diamonds: 5000000, salary: 948600 },
                15: { diamonds: 6000000, salary: 1139000 },
                16: { diamonds: 7000000, salary: 1327700 },
                17: { diamonds: 8000000, salary: 1518100 },
                18: { diamonds: 10000000, salary: 1881900 },
                19: { diamonds: 12200000, salary: 2284800 },
                20: { diamonds: 14000000, salary: 2723400 }
            },
            rewed: {
                1: 3400, 2: 6500, 3: 10000, 4: 15000, 5: 20000,
                6: 28000, 7: 45000, 8: 55000, 9: 80000, 10: 115000,
                11: 150000, 12: 200000, 13: 250000, 14: 310000, 15: 370000,
                16: 430000, 17: 490000, 18: 600000, 19: 710000, 20: 830000
            }
        };

        function markSalary(memberId, status) {
            attendanceData[memberId] = status;
            localStorage.setItem('vcrAttendance', JSON.stringify(attendanceData));
            displayMembers();
            displayAttendanceData();
            
            const member = members.find(m => m.id === memberId);
            alert(`${member.name} ditandai sebagai: ${status}`);
        }

        function showBonusModal(memberId) {
            currentMemberId = memberId;
            const member = members.find(m => m.id === memberId);
            
            document.getElementById('bonusModal').classList.remove('hidden');
            document.getElementById('bonusModal').classList.add('flex');
            
            // Reset form
            document.getElementById('bonusDolarAmount').value = '';
            document.getElementById('bonusDolarPreview').classList.add('hidden');
            
            // Show current bonus if exists
            const currentBonus = member.salaryData?.bonusDolar || 0;
            if (currentBonus > 0) {
                document.getElementById('bonusDolarAmount').value = currentBonus;
                updateBonusPreview();
            }
        }

        function showSalaryModal(memberId) {
            currentMemberId = memberId;
            const member = members.find(m => m.id === memberId);
            
            document.getElementById('salaryModal').classList.remove('hidden');
            document.getElementById('salaryModal').classList.add('flex');
            
            // Load existing salary data
            const memberSalary = member.salaryData || {};
            
            document.getElementById('coinLevel').value = memberSalary.coinLevel || '';
            document.getElementById('diamondLevel').value = memberSalary.diamondLevel || '';
            document.getElementById('rewedLevel').value = memberSalary.rewedLevel || '';
            
            // Update previews
            updateSalaryPreviews();
            updateCurrentBonusDisplay(member);
        }

        function updateBonusPreview() {
            const amount = parseInt(document.getElementById('bonusDolarAmount').value) || 0;
            const rupiah = amount * 17000;
            
            if (amount > 0) {
                document.getElementById('previewDolar').textContent = amount;
                document.getElementById('previewRupiah').textContent = rupiah.toLocaleString('id-ID');
                document.getElementById('bonusDolarPreview').classList.remove('hidden');
            } else {
                document.getElementById('bonusDolarPreview').classList.add('hidden');
            }
        }

        function updateSalaryPreviews() {
            const coinLevel = document.getElementById('coinLevel').value;
            const diamondLevel = document.getElementById('diamondLevel').value;
            const rewedLevel = document.getElementById('rewedLevel').value;
            
            // Update coin preview
            if (coinLevel && salaryData.coin[coinLevel]) {
                const coinData = salaryData.coin[coinLevel];
                document.getElementById('coinSalaryPreview').textContent = `Rp ${coinData.salary.toLocaleString('id-ID')}`;
                document.getElementById('totalCoinSalary').textContent = `Rp ${coinData.salary.toLocaleString('id-ID')}`;
            } else {
                document.getElementById('coinSalaryPreview').textContent = '';
                document.getElementById('totalCoinSalary').textContent = 'Rp 0';
            }
            
            // Update diamond preview
            if (diamondLevel && salaryData.diamond[diamondLevel]) {
                const diamondData = salaryData.diamond[diamondLevel];
                document.getElementById('diamondSalaryPreview').textContent = `Rp ${diamondData.salary.toLocaleString('id-ID')}`;
                document.getElementById('totalDiamondSalary').textContent = `Rp ${diamondData.salary.toLocaleString('id-ID')}`;
            } else {
                document.getElementById('diamondSalaryPreview').textContent = '';
                document.getElementById('totalDiamondSalary').textContent = 'Rp 0';
            }
            
            // Update rewed preview
            if (rewedLevel && salaryData.rewed[rewedLevel]) {
                const rewedSalary = salaryData.rewed[rewedLevel];
                document.getElementById('rewedSalaryPreview').textContent = `Rp ${rewedSalary.toLocaleString('id-ID')}`;
                document.getElementById('totalRewedSalary').textContent = `Rp ${rewedSalary.toLocaleString('id-ID')}`;
            } else {
                document.getElementById('rewedSalaryPreview').textContent = '';
                document.getElementById('totalRewedSalary').textContent = 'Rp 0';
            }
            
            // Update grand total
            updateGrandTotal();
        }

        function updateCurrentBonusDisplay(member) {
            const bonusDolar = member.salaryData?.bonusDolar || 0;
            const bonusRupiah = bonusDolar * 17000;
            document.getElementById('currentBonusDolar').textContent = `$${bonusDolar} (Rp ${bonusRupiah.toLocaleString('id-ID')})`;
        }

        function updateGrandTotal() {
            const coinSalary = parseInt(document.getElementById('totalCoinSalary').textContent.replace(/[^\d]/g, '')) || 0;
            const diamondSalary = parseInt(document.getElementById('totalDiamondSalary').textContent.replace(/[^\d]/g, '')) || 0;
            const rewedSalary = parseInt(document.getElementById('totalRewedSalary').textContent.replace(/[^\d]/g, '')) || 0;
            
            const grandTotal = coinSalary + diamondSalary + rewedSalary;
            document.getElementById('grandTotalSalary').textContent = `Rp ${grandTotal.toLocaleString('id-ID')}`;
        }

        function calculateTotalSalary(memberSalary) {
            let total = 0;
            
            if (memberSalary.coinLevel && salaryData.coin[memberSalary.coinLevel]) {
                total += salaryData.coin[memberSalary.coinLevel].salary;
            }
            
            if (memberSalary.diamondLevel && salaryData.diamond[memberSalary.diamondLevel]) {
                total += salaryData.diamond[memberSalary.diamondLevel].salary;
            }
            
            if (memberSalary.rewedLevel && salaryData.rewed[memberSalary.rewedLevel]) {
                total += salaryData.rewed[memberSalary.rewedLevel];
            }
            
            return total;
        }

        function saveBonusDolar() {
            if (!currentMemberId) return;
            
            const amount = parseInt(document.getElementById('bonusDolarAmount').value);
            
            if (!amount || amount < 1 || amount > 100) {
                alert('Masukkan jumlah dolar yang valid (1-100)!');
                return;
            }
            
            const memberIndex = members.findIndex(m => m.id === currentMemberId);
            if (memberIndex === -1) return;
            
            if (!members[memberIndex].salaryData) {
                members[memberIndex].salaryData = {};
            }
            
            members[memberIndex].salaryData.bonusDolar = amount;
            
            localStorage.setItem('vcrMembers', JSON.stringify(members));
            
            document.getElementById('bonusModal').classList.add('hidden');
            
            const rupiah = amount * 17000;
            alert(`Bonus dolar berhasil disimpan!\n\nJumlah: $${amount}\nNilai: Rp ${rupiah.toLocaleString('id-ID')}`);
            
            displayMembers();
            displayAttendanceData();
        }

        function saveSalaryData() {
            if (!currentMemberId) return;
            
            const coinLevel = document.getElementById('coinLevel').value;
            const diamondLevel = document.getElementById('diamondLevel').value;
            const rewedLevel = document.getElementById('rewedLevel').value;
            
            if (!coinLevel && !diamondLevel && !rewedLevel) {
                alert('Pilih minimal satu jenis gaji!');
                return;
            }
            
            const memberIndex = members.findIndex(m => m.id === currentMemberId);
            if (memberIndex === -1) return;
            
            if (!members[memberIndex].salaryData) {
                members[memberIndex].salaryData = {};
            }
            
            members[memberIndex].salaryData.coinLevel = coinLevel;
            members[memberIndex].salaryData.diamondLevel = diamondLevel;
            members[memberIndex].salaryData.rewedLevel = rewedLevel;
            
            localStorage.setItem('vcrMembers', JSON.stringify(members));
            
            document.getElementById('salaryModal').classList.add('hidden');
            
            const totalSalary = calculateTotalSalary(members[memberIndex].salaryData);
            alert(`Data gaji berhasil disimpan!\n\nTotal Gaji (Tanpa Dolar): Rp ${totalSalary.toLocaleString('id-ID')}`);
            
            displayMembers();
            displayAttendanceData();
        }

        function displayAttendanceData() {
            const container = document.getElementById('attendanceData');
            container.innerHTML = '';
            
            const table = document.createElement('div');
            table.className = 'overflow-x-auto';
            
            let tableHTML = `
                <table class="w-full border-collapse border border-gray-300">
                    <thead>
                        <tr class="bg-gray-100">
                            <th class="border border-gray-300 px-4 py-2">Nama</th>
                            <th class="border border-gray-300 px-4 py-2">ID</th>
                            <th class="border border-gray-300 px-4 py-2">Umur</th>
                            <th class="border border-gray-300 px-4 py-2">Bonus Dolar</th>
                            <th class="border border-gray-300 px-4 py-2">Total Gaji</th>
                            <th class="border border-gray-300 px-4 py-2">ID Bank</th>
                            <th class="border border-gray-300 px-4 py-2">Status Pembayaran</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            members.forEach(member => {
                const status = attendanceData[member.id] || 'BELUM DI GAJI';
                const statusClass = status === 'SUDAH DI GAJI' ? 'text-green-600' : status === 'BELUM DI GAJI' ? 'text-red-600' : 'text-gray-600';
                
                // Get member salary data
                const memberSalary = member.salaryData || {};
                const bonusDolar = memberSalary.bonusDolar || 0;
                const totalGaji = calculateTotalSalary(memberSalary);
                
                tableHTML += `
                    <tr>
                        <td class="border border-gray-300 px-4 py-2">${member.name}</td>
                        <td class="border border-gray-300 px-4 py-2">${member.id}</td>
                        <td class="border border-gray-300 px-4 py-2">${member.age}</td>
                        <td class="border border-gray-300 px-4 py-2 text-yellow-600 font-semibold">$${bonusDolar} (Rp ${(bonusDolar * 17000).toLocaleString('id-ID')})</td>
                        <td class="border border-gray-300 px-4 py-2 text-blue-600 font-semibold">Rp ${totalGaji.toLocaleString('id-ID')}</td>
                        <td class="border border-gray-300 px-4 py-2">${member.bank}</td>
                        <td class="border border-gray-300 px-4 py-2 ${statusClass} font-semibold">${status}</td>
                    </tr>
                `;
            });
            
            tableHTML += '</tbody></table>';
            table.innerHTML = tableHTML;
            container.appendChild(table);
        }

        function showProfile() {
            if (!currentUser) return;
            
            const modal = document.getElementById('profileModal');
            const content = document.getElementById('profileContent');
            
            const userRingClass = getVipRingClass(currentUser.vipLevel);
            const userFrameClass = getFrameClass(currentUser.vipLevel);
            
            content.innerHTML = `
                <div class="bg-gradient-to-br from-white via-blue-50 to-purple-50 rounded-xl p-6 border border-white/20 shadow-lg">
                    <div class="text-center mb-6">
                            <div class="w-24 h-24 mx-auto mb-4 ${userRingClass}">
                                <div class="vip-ring-inner">
                                    <div class="vip-ring-photo">
                                        ${currentUser.profileImage ? 
                                            `<img src="${currentUser.profileImage}" alt="Profile" class="w-full h-full object-cover rounded-full">` :
                                            `<i class="fas fa-${currentUser.isSpecialAdmin ? 'crown' : 'user'} text-3xl ${currentUser.isSpecialAdmin ? 'text-yellow-500' : 'text-gray-500'}"></i>`
                                        }
                                        <div class="profile-frame-overlay ${userFrameClass}"></div>
                                    </div>
                                </div>
                            </div>
                            <h3 class="text-xl font-bold ${currentUser.isSpecialAdmin ? 'text-yellow-600' : ''}">${currentUser.name}</h3>
                            ${currentUser.isSpecialAdmin ? '<div class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-bold mt-2">🔐 SUPER ADMIN</div>' : ''}
                            ${currentUser.verified ? '<i class="fas fa-check-circle text-green-500 text-xl"></i>' : ''}
                        </div>
                        
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="font-semibold">Nama:</span>
                                <span>${currentUser.name}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="font-semibold">Nomor HP:</span>
                                <span>${currentUser.phone}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="font-semibold">ID Bank:</span>
                                <span>${currentUser.bank}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="font-semibold">Umur:</span>
                                <span>${currentUser.age}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="font-semibold">Email:</span>
                                <span>${currentUser.email}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="font-semibold">Jenis Kelamin:</span>
                                <span>${currentUser.gender}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="font-semibold">ID:</span>
                                <span>${currentUser.id}</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="font-semibold">VIP:</span>
                                <div class="flex items-center space-x-2">
                                    <span class="px-2 py-1 ${currentUser.isSpecialAdmin ? 'bg-yellow-100 text-yellow-800' : 'bg-yellow-100 text-yellow-800'} rounded text-sm">${currentUser.vipLevel}</span>
                                    ${currentUser.vipLevel === 'Regular' && currentUser.processingStatus !== 'pending' && !currentUser.isSpecialAdmin ? 
                                        '<button onclick="showVipUpgrade()" class="bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600">Upgrade</button>' : 
                                        ''
                                    }
                                </div>
                            </div>
                            ${currentUser.isSpecialAdmin ? `
                            <div class="bg-yellow-50 rounded-lg p-3 mt-3">
                                <div class="flex items-center mb-2">
                                    <i class="fas fa-shield-alt text-yellow-600 mr-2"></i>
                                    <span class="font-semibold text-yellow-800">Akses Super Admin</span>
                                </div>
                                <div class="text-sm text-yellow-700 space-y-1">
                                    <p>✅ Akses penuh ke semua member</p>
                                    <p>✅ Kontrol kehadiran semua member</p>
                                    <p>✅ Manajemen sistem lengkap</p>
                                    <p>✅ Tidak perlu upgrade VIP</p>
                                </div>
                            </div>
                            ` : ''}
                            ${currentUser.processingStatus === 'pending' ? `
                            <div class="bg-blue-50 rounded-lg p-3 mt-3">
                                <div class="flex items-center mb-2">
                                    <i class="fas fa-clock text-blue-600 mr-2"></i>
                                    <span class="font-semibold text-blue-800">Sedang Diproses</span>
                                </div>
                                <div class="text-sm text-blue-700 space-y-1">
                                    <p><strong>Upgrade ke:</strong> ${currentUser.pendingVipLevel}</p>
                                    <p><strong>Metode Pembayaran:</strong> ${currentUser.paymentMethod}</p>
                                    <p><strong>Sisa Waktu:</strong> ${getProcessingTimeRemaining(currentUser) || 'Menghitung...'}</p>
                                    <p><strong>Selesai pada:</strong> ${new Date(currentUser.processingCompletionTime).toLocaleString('id-ID')}</p>
                                </div>
                            </div>
                            ` : ''}
                            <div class="flex justify-between">
                                <span class="font-semibold">Tgl Pendaftaran:</span>
                                <span>${currentUser.registrationDate}</span>
                            </div>
                        </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function showVipUpgrade() {
            document.getElementById('profileModal').classList.add('hidden');
            document.getElementById('vipModal').classList.remove('hidden');
            document.getElementById('vipModal').classList.add('flex');
        }

        function showPaymentModal() {
            if (!selectedVipLevel) {
                alert('Pilih level VIP terlebih dahulu!');
                return;
            }
            
            // Update payment summary
            document.getElementById('paymentVipLevel').textContent = selectedVipLevel;
            document.getElementById('paymentAmount').textContent = 'Rp ' + parseInt(selectedVipPrice).toLocaleString('id-ID');
            
            // Hide VIP modal and show payment modal
            document.getElementById('vipModal').classList.add('hidden');
            document.getElementById('paymentModal').classList.remove('hidden');
            document.getElementById('paymentModal').classList.add('flex');
            
            // Reset payment selection
            document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('border-blue-500', 'bg-blue-50'));
            document.getElementById('selectedPaymentInfo').classList.add('hidden');
            document.getElementById('processPayment').disabled = true;
        }

        function showQRISModal() {
            document.getElementById('qrisModal').classList.remove('hidden');
            document.getElementById('qrisModal').classList.add('flex');
        }

        function processVipUpgrade() {
            if (!selectedVipLevel) {
                alert('Pilih level VIP terlebih dahulu!');
                return;
            }
            
            // Get selected payment method
            const selectedPaymentMethod = document.querySelector('.payment-method.border-blue-500');
            if (!selectedPaymentMethod) {
                alert('Pilih metode pembayaran terlebih dahulu!');
                return;
            }
            
            const paymentMethod = selectedPaymentMethod.dataset.method;
            const paymentNumber = selectedPaymentMethod.dataset.number;
            
            // Check if payment proof is uploaded
            const paymentProof = document.getElementById('paymentProof').files[0];
            if (!paymentProof) {
                alert('Silakan upload bukti pembayaran terlebih dahulu!');
                return;
            }
            
            // Simulate payment process
            let confirmMessage = `Konfirmasi pembayaran ${selectedVipLevel} sebesar Rp ${parseInt(selectedVipPrice).toLocaleString('id-ID')} melalui ${paymentMethod}`;
            if (paymentNumber !== 'Scan QR Code') {
                confirmMessage += `\nNomor: ${paymentNumber}`;
            }
            confirmMessage += `\nBukti pembayaran: ${paymentProof.name}`;
            
            const confirmed = confirm(confirmMessage);
            
            if (confirmed) {
                // Set processing status
                currentUser.processingStatus = 'pending';
                currentUser.pendingVipLevel = selectedVipLevel;
                currentUser.paymentMethod = paymentMethod;
                currentUser.paymentNumber = paymentNumber;
                currentUser.paymentProofName = paymentProof.name;
                
                // Calculate processing time
                let processingTime;
                let processingMessage;
                
                if (selectedVipLevel === 'ADMIN') {
                    // ADMIN: 1 hari kerja (24 jam)
                    processingTime = 24 * 60 * 60 * 1000; // 24 hours in milliseconds
                    processingMessage = '1 hari kerja (24 jam)';
                } else {
                    // VIP 1 sampai MASTER: 2 jam
                    processingTime = 2 * 60 * 60 * 1000; // 2 hours in milliseconds
                    processingMessage = '2 jam';
                }
                
                // Set processing completion time
                const completionTime = new Date(Date.now() + processingTime);
                currentUser.processingCompletionTime = completionTime.toISOString();
                
                // Update in members array
                const memberIndex = members.findIndex(m => m.id === currentUser.id);
                if (memberIndex !== -1) {
                    members[memberIndex] = currentUser;
                    localStorage.setItem('vcrMembers', JSON.stringify(members));
                }
                
                // Update current user in localStorage
                localStorage.setItem('vcrCurrentUser', JSON.stringify(currentUser));
                
                // Start processing timer
                startProcessingTimer(currentUser.id, processingTime);
                
                document.getElementById('paymentModal').classList.add('hidden');
                alert(`Pembayaran berhasil melalui ${paymentMethod}! 
                
Bukti pembayaran telah diterima dan sedang diproses.
                
⏰ Waktu pemrosesan: ${processingMessage}
📅 Selesai pada: ${completionTime.toLocaleString('id-ID')}
                
Akun Anda akan otomatis diupgrade ke ${selectedVipLevel} setelah pemrosesan selesai.`);
                
                // Reset selections
                selectedVipLevel = null;
                selectedVipPrice = null;
                document.querySelectorAll('.vip-option').forEach(opt => opt.classList.remove('border-blue-500', 'bg-blue-50'));
                document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('border-blue-500', 'bg-blue-50'));
                document.getElementById('paymentProof').value = '';
                
                displayMembers();
                showProfile(); // Refresh profile to show processing status
            }
        }

        function checkAutoReset() {
            const lastReset = localStorage.getItem('vcrLastReset');
            const now = new Date();
            const currentMonday = getMonday(now);
            
            if (!lastReset || new Date(lastReset) < currentMonday) {
                // Reset attendance data every 2 weeks on Monday
                const weeksSinceLastReset = lastReset ? 
                    Math.floor((currentMonday - new Date(lastReset)) / (1000 * 60 * 60 * 24 * 7)) : 2;
                
                if (weeksSinceLastReset >= 2) {
                    attendanceData = {};
                    localStorage.setItem('vcrAttendance', JSON.stringify(attendanceData));
                    localStorage.setItem('vcrLastReset', currentMonday.toISOString());
                }
            }
        }

        function getMonday(date) {
            const d = new Date(date);
            const day = d.getDay();
            const diff = d.getDate() - day + (day === 0 ? -6 : 1);
            return new Date(d.setDate(diff));
        }

        function startProcessingTimer(memberId, processingTime) {
            setTimeout(() => {
                completeVipUpgrade(memberId);
            }, processingTime);
        }

        function completeVipUpgrade(memberId) {
            // Find member in array
            const memberIndex = members.findIndex(m => m.id === memberId);
            if (memberIndex === -1) return;
            
            const member = members[memberIndex];
            
            // Check if still pending
            if (member.processingStatus !== 'pending') return;
            
            // Complete the upgrade
            member.vipLevel = member.pendingVipLevel;
            member.verified = true;
            member.processingStatus = 'completed';
            member.upgradeCompletedAt = new Date().toISOString();
            
            // Clean up processing data
            delete member.pendingVipLevel;
            delete member.processingCompletionTime;
            
            // Update members array
            members[memberIndex] = member;
            localStorage.setItem('vcrMembers', JSON.stringify(members));
            
            // Update current user if it's the same user
            if (currentUser && currentUser.id === memberId) {
                currentUser = member;
                localStorage.setItem('vcrCurrentUser', JSON.stringify(currentUser));
                
                // Show completion notification
                alert(`🎉 Selamat! Upgrade VIP Anda telah selesai diproses!
                
✅ Akun Anda sekarang: ${member.vipLevel}
✅ Status: Terverifikasi
📅 Selesai pada: ${new Date().toLocaleString('id-ID')}
                
Terima kasih telah menggunakan layanan Chamelion Agency!`);
                
                // Refresh display
                displayMembers();
                if (document.getElementById('profileModal').classList.contains('flex')) {
                    showProfile();
                }
            }
        }

        function checkPendingProcessing() {
            const now = new Date();
            
            members.forEach(member => {
                if (member.processingStatus === 'pending' && member.processingCompletionTime) {
                    const completionTime = new Date(member.processingCompletionTime);
                    
                    if (now >= completionTime) {
                        // Processing time has passed, complete the upgrade
                        completeVipUpgrade(member.id);
                    } else {
                        // Still processing, set timer for remaining time
                        const remainingTime = completionTime - now;
                        startProcessingTimer(member.id, remainingTime);
                    }
                }
            });
        }

        function getProcessingTimeRemaining(member) {
            if (member.processingStatus !== 'pending' || !member.processingCompletionTime) {
                return null;
            }
            
            const now = new Date();
            const completionTime = new Date(member.processingCompletionTime);
            const remaining = completionTime - now;
            
            if (remaining <= 0) {
                return 'Selesai';
            }
            
            const hours = Math.floor(remaining / (1000 * 60 * 60));
            const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
            
            if (hours > 0) {
                return `${hours} jam ${minutes} menit`;
            } else {
                return `${minutes} menit`;
            }
        }

        function toggleAccountOptions() {
            const accountType = document.getElementById('adminRegAccountType').value;
            const bankSection = document.getElementById('bankSection');
            const ewalletSection = document.getElementById('ewalletSection');
            const numberLabel = document.getElementById('numberLabel');
            const accountNumber = document.getElementById('adminRegAccountNumber');
            
            // Hide both sections first
            bankSection.classList.add('hidden');
            ewalletSection.classList.add('hidden');
            
            // Reset required attributes
            document.getElementById('adminRegBankName').removeAttribute('required');
            document.getElementById('adminRegEwalletName').removeAttribute('required');
            
            if (accountType === 'bank') {
                bankSection.classList.remove('hidden');
                document.getElementById('adminRegBankName').setAttribute('required', 'required');
                numberLabel.textContent = 'Nomor Rekening:';
                accountNumber.placeholder = 'Masukkan nomor rekening';
            } else if (accountType === 'ewallet') {
                ewalletSection.classList.remove('hidden');
                document.getElementById('adminRegEwalletName').setAttribute('required', 'required');
                numberLabel.textContent = 'Nomor HP/ID:';
                accountNumber.placeholder = 'Masukkan nomor HP atau ID E-Wallet';
            } else {
                numberLabel.textContent = 'Nomor Rekening/HP:';
                accountNumber.placeholder = 'Masukkan nomor rekening atau nomor HP';
            }
        }

        function handleAdminCreateMember(e) {
            e.preventDefault();
            
            // Check if user is admin
            if (!currentUser || (currentUser.vipLevel !== 'ADMIN' && !currentUser.isSpecialAdmin)) {
                alert('Akses ditolak! Hanya admin yang dapat membuat akun member.');
                return;
            }
            
            const name = document.getElementById('adminRegName').value;
            const age = parseInt(document.getElementById('adminRegAge').value);
            const customId = document.getElementById('adminRegId').value.trim();
            const gender = document.getElementById('adminRegGender').value;
            const phone = document.getElementById('adminRegPhone').value;
            const accountType = document.getElementById('adminRegAccountType').value;
            const accountNumber = document.getElementById('adminRegAccountNumber').value;
            const email = document.getElementById('adminRegEmail').value;
            const vipLevel = document.getElementById('adminRegVipLevel').value;
            const verified = document.getElementById('adminRegVerified').value === 'true';
            
            let bank = '';
            
            if (accountType === 'bank') {
                const bankName = document.getElementById('adminRegBankName').value;
                if (!bankName) {
                    alert('Pilih bank terlebih dahulu!');
                    return;
                }
                bank = `${bankName} - ${accountNumber}`;
            } else if (accountType === 'ewallet') {
                const ewalletName = document.getElementById('adminRegEwalletName').value;
                if (!ewalletName) {
                    alert('Pilih E-Wallet terlebih dahulu!');
                    return;
                }
                bank = `${ewalletName} - ${accountNumber}`;
            } else {
                alert('Pilih tipe akun terlebih dahulu!');
                return;
            }
            
            // Validations
            if (age < 20 || age > 50) {
                alert('Maaf, umur harus antara 20-50 tahun!');
                return;
            }
            
            // Validate custom ID format (only numbers)
            if (!customId || customId.length < 1) {
                alert('ID Member harus diisi dengan angka!');
                return;
            }
            
            // Check if ID already exists
            if (members.find(m => m.id === customId)) {
                alert('ID Member sudah digunakan! Silakan gunakan ID yang berbeda.');
                return;
            }
            
            if (members.find(m => m.phone === phone)) {
                alert('Nomor HP sudah terdaftar!');
                return;
            }
            
            if (members.find(m => m.email === email)) {
                alert('Email sudah terdaftar!');
                return;
            }
            
            // Create new member
            const newMember = {
                id: customId,
                name,
                age,
                gender,
                phone,
                bank,
                email,
                vipLevel,
                verified,
                registrationDate: new Date().toLocaleDateString('id-ID'),
                profileImage: null,
                createdByAdmin: true,
                createdBy: currentUser.name,
                isDataOnly: true
            };
            
            // Handle profile image
            const imageFile = document.getElementById('adminProfileImage').files[0];
            if (imageFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    newMember.profileImage = e.target.result;
                    saveAdminCreatedMember(newMember);
                };
                reader.readAsDataURL(imageFile);
            } else {
                saveAdminCreatedMember(newMember);
            }
        }

        function saveAdminCreatedMember(member) {
            members.push(member);
            localStorage.setItem('vcrMembers', JSON.stringify(members));
            
            // Show success message
            const successDiv = document.getElementById('adminCreateSuccess');
            const successMessage = document.getElementById('adminSuccessMessage');
            
            successMessage.innerHTML = `
                <strong>ID Member:</strong> ${member.id}<br>
                <strong>Nama:</strong> ${member.name}<br>
                <strong>HP:</strong> ${member.phone}<br>
                <strong>VIP Level:</strong> ${member.vipLevel}<br>
                <strong>Status:</strong> ${member.verified ? 'Terverifikasi' : 'Belum Terverifikasi'}<br>
                <strong>Tipe:</strong> Data Member (Bukan Akun Login)
            `;
            
            successDiv.classList.remove('hidden');
            
            // Reset form
            document.getElementById('adminCreateMemberForm').reset();
            document.getElementById('adminImagePreview').classList.add('hidden');
            
            // Refresh member display
            displayMembers();
            
            alert(`✅ Data member berhasil disimpan!

📋 Detail Member:
• ID: ${member.id}
• Nama: ${member.name}
• HP: ${member.phone}
• VIP: ${member.vipLevel}
• Status: ${member.verified ? 'Terverifikasi' : 'Belum Terverifikasi'}

⚠️ Catatan: Data ini hanya untuk pencatatan, bukan akun login.`);
            
            // Hide success message after 10 seconds
            setTimeout(() => {
                successDiv.classList.add('hidden');
            }, 10000);
        }

        function resetAdminForm() {
            document.getElementById('adminCreateMemberForm').reset();
            document.getElementById('adminImagePreview').classList.add('hidden');
            document.getElementById('adminCreateSuccess').classList.add('hidden');
            
            // Reset account type sections
            document.getElementById('bankSection').classList.add('hidden');
            document.getElementById('ewalletSection').classList.add('hidden');
            document.getElementById('numberLabel').textContent = 'Nomor Rekening/HP:';
            document.getElementById('adminRegAccountNumber').placeholder = 'Masukkan nomor rekening atau nomor HP';
            
            // Reset required attributes
            document.getElementById('adminRegBankName').removeAttribute('required');
            document.getElementById('adminRegEwalletName').removeAttribute('required');
        }

        function previewAdminImage() {
            const file = document.getElementById('adminProfileImage').files[0];
            const preview = document.getElementById('adminImagePreview');
            const previewImg = document.getElementById('adminPreviewImg');
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImg.src = e.target.result;
                    preview.classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            } else {
                preview.classList.add('hidden');
            }
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('vcrCurrentUser');
            document.getElementById('logoutBtn').classList.add('hidden');
            showSection('welcomeSection');
            alert('Anda telah logout');
        }

        // Google Sheets Integration
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/library/d/1jORI-t5rNR7moFqnggeblzdMQeSL420aw7JKji4l2ds2C5F_ybgAuqFp/2';

        function sendDataToGoogleSheets() {
            // Show loading status
            showSendStatus('loading', 'Mengirim Data...', 'Sedang mengirim data ke Google Sheets, mohon tunggu...');
            
            // Prepare data to send
            const dataToSend = {
                timestamp: new Date().toISOString(),
                members: members.map(member => {
                    const memberSalary = member.salaryData || {};
                    const bonusDolar = memberSalary.bonusDolar || 0;
                    const totalGaji = calculateTotalSalary(memberSalary);
                    const status = attendanceData[member.id] || 'BELUM DI GAJI';
                    
                    return {
                        nama: member.name,
                        id: member.id,
                        umur: member.age,
                        gender: member.gender,
                        phone: member.phone,
                        email: member.email,
                        bank: member.bank,
                        vipLevel: member.vipLevel,
                        verified: member.verified ? 'Ya' : 'Tidak',
                        bonusDolar: bonusDolar,
                        bonusRupiah: bonusDolar * 17000,
                        totalGaji: totalGaji,
                        statusPembayaran: status,
                        registrationDate: member.registrationDate,
                        // Salary details
                        coinLevel: memberSalary.coinLevel || '',
                        diamondLevel: memberSalary.diamondLevel || '',
                        rewedLevel: memberSalary.rewedLevel || '',
                        coinSalary: memberSalary.coinLevel ? salaryData.coin[memberSalary.coinLevel]?.salary || 0 : 0,
                        diamondSalary: memberSalary.diamondLevel ? salaryData.diamond[memberSalary.diamondLevel]?.salary || 0 : 0,
                        rewedSalary: memberSalary.rewedLevel ? salaryData.rewed[memberSalary.rewedLevel] || 0 : 0
                    };
                }),
                summary: {
                    totalMembers: members.length,
                    sudahDigaji: Object.values(attendanceData).filter(status => status === 'SUDAH DI GAJI').length,
                    belumDigaji: Object.values(attendanceData).filter(status => status === 'BELUM DI GAJI').length,
                    totalBonusDolar: members.reduce((sum, member) => sum + (member.salaryData?.bonusDolar || 0), 0),
                    totalGajiKeseluruhan: members.reduce((sum, member) => sum + calculateTotalSalary(member.salaryData || {}), 0),
                    exportDate: new Date().toLocaleString('id-ID'),
                    exportedBy: currentUser?.name || 'Unknown'
                }
            };
            
            // Send data to Google Apps Script
            fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors', // Required for Google Apps Script
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(dataToSend)
            })
            .then(() => {
                // Since we're using no-cors mode, we can't read the response
                // We'll assume success after a reasonable delay
                setTimeout(() => {
                    showSendStatus('success', 'Data Berhasil Dikirim!', 
                        `Data ${members.length} member telah berhasil dikirim ke Google Sheets pada ${new Date().toLocaleString('id-ID')}`);
                }, 2000);
            })
            .catch(error => {
                console.error('Error sending data:', error);
                showSendStatus('error', 'Gagal Mengirim Data', 
                    'Terjadi kesalahan saat mengirim data. Pastikan URL Google Script sudah benar dan aktif.');
            });
        }

        function showSendStatus(type, title, message) {
            const statusDiv = document.getElementById('sendStatus');
            const statusIcon = document.getElementById('statusIcon');
            const statusTitle = document.getElementById('statusTitle');
            const statusMessage = document.getElementById('statusMessage');
            
            // Reset classes
            statusDiv.className = 'mt-4 p-4 rounded-lg';
            
            switch(type) {
                case 'loading':
                    statusDiv.classList.add('bg-blue-50');
                    statusIcon.className = 'fas fa-spinner fa-spin text-blue-600 text-xl mr-3';
                    statusTitle.className = 'font-bold text-blue-800';
                    statusMessage.className = 'text-sm mt-1 text-blue-700';
                    break;
                case 'success':
                    statusDiv.classList.add('bg-green-50');
                    statusIcon.className = 'fas fa-check-circle text-green-600 text-xl mr-3';
                    statusTitle.className = 'font-bold text-green-800';
                    statusMessage.className = 'text-sm mt-1 text-green-700';
                    break;
                case 'error':
                    statusDiv.classList.add('bg-red-50');
                    statusIcon.className = 'fas fa-exclamation-circle text-red-600 text-xl mr-3';
                    statusTitle.className = 'font-bold text-red-800';
                    statusMessage.className = 'text-sm mt-1 text-red-700';
                    break;
            }
            
            statusTitle.textContent = title;
            statusMessage.textContent = message;
            statusDiv.classList.remove('hidden');
            
            // Auto hide after 10 seconds for success/error
            if (type !== 'loading') {
                setTimeout(() => {
                    statusDiv.classList.add('hidden');
                }, 10000);
            }
        }

        // Function to get Google Apps Script setup instructions
        function showGoogleScriptSetup() {
            const instructions = `
📋 CARA SETUP GOOGLE APPS SCRIPT:

1️⃣ Buka https://script.google.com
2️⃣ Klik "New Project"
3️⃣ Ganti nama project menjadi "Chameleon Agency Data"
4️⃣ Hapus kode default dan paste kode berikut:

function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);
    const spreadsheetId = 'YOUR_SPREADSHEET_ID'; // Ganti dengan ID spreadsheet Anda
    const ss = SpreadsheetApp.openById(spreadsheetId);
    
    // Create or get sheet
    let sheet = ss.getSheetByName('Gaji Member Chameleon');
    if (!sheet) {
      sheet = ss.insertSheet('Gaji Member Chameleon');
      
      // Add headers
      const headers = [
        'Timestamp', 'Nama', 'ID Member', 'Umur', 'Gender', 'Phone', 'Email', 
        'Bank/E-Wallet', 'VIP Level', 'Verified', 'Bonus Dolar', 'Bonus Rupiah',
        'Coin Level', 'Coin Salary', 'Diamond Level', 'Diamond Salary', 
        'Rewed Level', 'Rewed Salary', 'Total Gaji', 'Status Pembayaran', 
        'Tanggal Daftar'
      ];
      sheet.getRange(1, 1, 1, headers.length).setValues([headers]);
    }
    
    // Add data
    const timestamp = new Date().toLocaleString('id-ID');
    data.members.forEach(member => {
      const row = [
        timestamp, member.nama, member.id, member.umur, member.gender,
        member.phone, member.email, member.bank, member.vipLevel, member.verified,
        member.bonusDolar, member.bonusRupiah, member.coinLevel, member.coinSalary,
        member.diamondLevel, member.diamondSalary, member.rewedLevel, member.rewedSalary,
        member.totalGaji, member.statusPembayaran, member.registrationDate
      ];
      sheet.appendRow(row);
    });
    
    return ContentService.createTextOutput('Success');
  } catch (error) {
    return ContentService.createTextOutput('Error: ' + error.toString());
  }
}

5️⃣ Klik "Deploy" > "New Deployment"
6️⃣ Pilih type "Web app"
7️⃣ Execute as: "Me"
8️⃣ Who has access: "Anyone"
9️⃣ Klik "Deploy" dan copy URL yang diberikan
🔟 Ganti GOOGLE_SCRIPT_URL di kode dengan URL tersebut

📊 CARA BUAT GOOGLE SPREADSHEET:
1. Buka https://sheets.google.com
2. Buat spreadsheet baru
3. Copy ID dari URL (bagian setelah /d/ dan sebelum /edit)
4. Ganti YOUR_SPREADSHEET_ID di script dengan ID tersebut
            `;
            
            alert(instructions);
        }
        
        // Add setup button (you can call this function to show instructions)
        // showGoogleScriptSetup();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97f5dc71a01f7975',t:'MTc1NzkxNTU3OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
